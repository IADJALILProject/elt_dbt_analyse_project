[0m16:59:26.696617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F68094D70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F67E76A50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F67E74F20>]}


============================== 16:59:26.703000 | a729ed7e-789c-4779-9ec3-588e60a74e25 ==============================
[0m16:59:26.703000 [info ] [MainThread]: Running with dbt=1.9.1
[0m16:59:26.703000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:26.736108 [info ] [MainThread]: dbt version: 1.9.1
[0m16:59:26.736108 [info ] [MainThread]: python version: 3.12.4
[0m16:59:26.736108 [info ] [MainThread]: python path: C:\Users\lenovo\AppData\Local\Programs\Python\Python312\python.exe
[0m16:59:26.736108 [info ] [MainThread]: os info: Windows-10-10.0.19045-SP0
[0m16:59:26.844092 [info ] [MainThread]: Using profiles dir at C:\Users\lenovo\.dbt
[0m16:59:26.844092 [info ] [MainThread]: Using profiles.yml file at C:\Users\lenovo\.dbt\profiles.yml
[0m16:59:26.844092 [info ] [MainThread]: Using dbt_project.yml file at C:\Users\lenovo\my_dbt_project\dbt_project.yml
[0m16:59:26.844092 [info ] [MainThread]: adapter type: postgres
[0m16:59:26.844092 [info ] [MainThread]: adapter version: 1.9.0
[0m16:59:26.986027 [info ] [MainThread]: Configuration:
[0m16:59:26.994029 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m16:59:26.994029 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m16:59:26.994029 [info ] [MainThread]: Required dependencies:
[0m16:59:26.994029 [debug] [MainThread]: Executing "git --help"
[0m16:59:27.027402 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m16:59:27.027402 [debug] [MainThread]: STDERR: "b''"
[0m16:59:27.036009 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m16:59:27.036009 [info ] [MainThread]: Connection:
[0m16:59:27.036009 [info ] [MainThread]:   host: localhost
[0m16:59:27.036009 [info ] [MainThread]:   port: 5432
[0m16:59:27.036009 [info ] [MainThread]:   user: postgres
[0m16:59:27.036009 [info ] [MainThread]:   database: sales_db
[0m16:59:27.036009 [info ] [MainThread]:   schema: public
[0m16:59:27.036009 [info ] [MainThread]:   connect_timeout: 10
[0m16:59:27.036009 [info ] [MainThread]:   role: None
[0m16:59:27.036009 [info ] [MainThread]:   search_path: None
[0m16:59:27.044009 [info ] [MainThread]:   keepalives_idle: 0
[0m16:59:27.044009 [info ] [MainThread]:   sslmode: None
[0m16:59:27.044009 [info ] [MainThread]:   sslcert: None
[0m16:59:27.044009 [info ] [MainThread]:   sslkey: None
[0m16:59:27.044009 [info ] [MainThread]:   sslrootcert: None
[0m16:59:27.044009 [info ] [MainThread]:   application_name: dbt
[0m16:59:27.044009 [info ] [MainThread]:   retries: 1
[0m16:59:27.044009 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m16:59:27.327246 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m16:59:27.410569 [debug] [MainThread]: Using postgres connection "debug"
[0m16:59:27.410569 [debug] [MainThread]: On debug: select 1 as id
[0m16:59:27.410569 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:27.460586 [debug] [MainThread]: SQL status: SELECT 1 in 0.052 seconds
[0m16:59:27.460586 [debug] [MainThread]: On debug: Close
[0m16:59:27.460586 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m16:59:27.460586 [info ] [MainThread]: [32mAll checks passed![0m
[0m16:59:27.469332 [debug] [MainThread]: Command `dbt debug` succeeded at 16:59:27.469332 after 0.98 seconds
[0m16:59:27.469332 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m16:59:27.469332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F67961160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F67962FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028F68A1A930>]}
[0m16:59:27.469332 [debug] [MainThread]: Flushing usage events
[0m16:59:27.919602 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:30.016612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167D85A1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DB275CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DB2744D0>]}


============================== 17:12:30.016612 | 8bb756e4-8adf-4404-b385-0099b9108121 ==============================
[0m17:12:30.016612 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:12:30.024614 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:12:30.374442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DB40DBE0>]}
[0m17:12:30.474428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DB2FC500>]}
[0m17:12:30.474428 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:30.841043 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:12:30.849725 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:12:30.849725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC528740>]}
[0m17:12:33.673585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC9E0BC0>]}
[0m17:12:33.773555 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:12:33.782227 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:12:33.865506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC94D850>]}
[0m17:12:33.873507 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:12:33.873507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC9B0E60>]}
[0m17:12:33.873507 [info ] [MainThread]: 
[0m17:12:33.873507 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:33.873507 [info ] [MainThread]: 
[0m17:12:33.882237 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:33.882237 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:12:34.041055 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:12:34.041055 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:12:34.041055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:34.090115 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m17:12:34.099982 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:12:34.099982 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:12:34.107984 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:12:34.107984 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:12:34.107984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:34.165486 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m17:12:34.165486 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:12:34.173489 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:12:34.173489 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.007 seconds
[0m17:12:34.182123 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:12:34.182123 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:12:34.182123 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.190124 [debug] [MainThread]: On master: BEGIN
[0m17:12:34.190124 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:34.241382 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:12:34.241382 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.241382 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:34.248787 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m17:12:34.248787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC94C170>]}
[0m17:12:34.256786 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:34.256786 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.256786 [debug] [MainThread]: On master: BEGIN
[0m17:12:34.256786 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:12:34.256786 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.256786 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.256786 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.264787 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:34.264787 [debug] [MainThread]: On master: Close
[0m17:12:34.264787 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:12:34.264787 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example ..................................... [RUN]
[0m17:12:34.272786 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:12:34.272786 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:12:34.288785 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:12:34.288785 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:12:34.352778 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:12:34.360778 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:12:34.360778 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:12:34.360778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:12:34.415484 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m17:12:34.415484 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:12:34.415484 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    "-- dbt model example.sql" 

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users;
  );
[0m17:12:34.423484 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « "-- dbt model example.sql" »
LINE 7:     "-- dbt model example.sql" 
            ^

[0m17:12:34.423484 [debug] [Thread-1 (]: On model.my_dbt_project.example: ROLLBACK
[0m17:12:34.423484 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:12:34.548692 [debug] [Thread-1 (]: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « "-- dbt model example.sql" »
  LINE 7:     "-- dbt model example.sql" 
              ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:12:34.556695 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC72F770>]}
[0m17:12:34.556695 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.example ............................ [[31mERROR[0m in 0.28s]
[0m17:12:34.556695 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:12:34.556695 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:12:34.556695 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.example' to be skipped because of status 'error'.  Reason: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « "-- dbt model example.sql" »
  LINE 7:     "-- dbt model example.sql" 
              ^
  compiled code at target\run\my_dbt_project\models\example.sql.
[0m17:12:34.556695 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:12:34.564693 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:12:34.565387 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:12:34.565387 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.573389 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:12:34.615318 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.615318 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.615318 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m17:12:34.615318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:34.689954 [debug] [Thread-1 (]: SQL status: BEGIN in 0.072 seconds
[0m17:12:34.689954 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.689954 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:12:34.698637 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.007 seconds
[0m17:12:34.714640 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.715273 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:12:34.715273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:34.756552 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:12:34.756552 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.756552 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:12:34.756552 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:12:34.765265 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_first_dbt_model__dbt_backup"
[0m17:12:34.773266 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:12:34.773266 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "sales_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:12:34.781924 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:12:34.781924 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m17:12:34.781924 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167D86A7680>]}
[0m17:12:34.781924 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.22s]
[0m17:12:34.781924 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:12:34.789924 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:12:34.789924 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:12:34.789924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:12:34.789924 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:12:34.789924 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.798694 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:12:34.806694 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.806694 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.806694 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m17:12:34.806694 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:34.865179 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m17:12:34.865179 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.865179 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "sales_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "sales_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:12:34.873179 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:12:34.881868 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.881868 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:12:34.881868 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:12:34.881868 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:12:34.881868 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.881868 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:12:34.889870 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:12:34.889870 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_second_dbt_model__dbt_backup"
[0m17:12:34.898547 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:12:34.898547 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "sales_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:12:34.898547 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:12:34.898547 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m17:12:34.898547 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bb756e4-8adf-4404-b385-0099b9108121', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DD3B0560>]}
[0m17:12:34.906546 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m17:12:34.906546 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:12:34.906546 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.906546 [debug] [MainThread]: On master: BEGIN
[0m17:12:34.906546 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:34.956577 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:12:34.956577 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.956577 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:34.956577 [debug] [MainThread]: On master: COMMIT
[0m17:12:34.956577 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:34.956577 [debug] [MainThread]: On master: Close
[0m17:12:34.956577 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:34.964575 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:12:34.965227 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:12:34.965227 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m17:12:34.965227 [info ] [MainThread]: 
[0m17:12:34.965227 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 1.08 seconds (1.08s).
[0m17:12:34.965227 [debug] [MainThread]: Command end result
[0m17:12:34.998624 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:12:35.006625 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:12:35.015221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:12:35.015221 [info ] [MainThread]: 
[0m17:12:35.015221 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:12:35.015221 [info ] [MainThread]: 
[0m17:12:35.023221 [error] [MainThread]:   Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « "-- dbt model example.sql" »
  LINE 7:     "-- dbt model example.sql" 
              ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:12:35.023221 [info ] [MainThread]: 
[0m17:12:35.023221 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:12:35.023221 [debug] [MainThread]: Command `dbt run` failed at 17:12:35.023221 after 5.21 seconds
[0m17:12:35.023221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DC9681A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DB30D940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000167DA7499A0>]}
[0m17:12:35.023221 [debug] [MainThread]: Flushing usage events
[0m17:12:35.498299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:13:47.169623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02604F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02606420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02605340>]}


============================== 17:13:47.178309 | 9facc345-b273-4c84-96f4-c14cb2a6ef34 ==============================
[0m17:13:47.178309 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:13:47.178309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:13:47.494812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE0299CF80>]}
[0m17:13:47.611512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE027FD2B0>]}
[0m17:13:47.611512 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:13:47.936056 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:13:48.136027 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:13:48.144026 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\example.sql
[0m17:13:48.535899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE041A93D0>]}
[0m17:13:48.619214 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:13:48.627881 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:13:48.661181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE041721E0>]}
[0m17:13:48.669182 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:13:48.669182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02C063F0>]}
[0m17:13:48.669182 [info ] [MainThread]: 
[0m17:13:48.669182 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:13:48.669182 [info ] [MainThread]: 
[0m17:13:48.677940 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:13:48.685940 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:13:48.777853 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:13:48.777853 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:13:48.777853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:48.844509 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.061 seconds
[0m17:13:48.844509 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:13:48.844509 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:13:48.861133 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:13:48.861133 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:13:48.861133 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:13:48.919148 [debug] [ThreadPool]: SQL status: BEGIN in 0.054 seconds
[0m17:13:48.919148 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:13:48.919148 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:13:48.927811 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m17:13:48.927811 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:13:48.927811 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:13:48.935810 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:48.944368 [debug] [MainThread]: On master: BEGIN
[0m17:13:48.944474 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:13:48.994460 [debug] [MainThread]: SQL status: BEGIN in 0.053 seconds
[0m17:13:48.994460 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:48.994460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:13:49.010461 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:13:49.011126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04600320>]}
[0m17:13:49.011126 [debug] [MainThread]: On master: ROLLBACK
[0m17:13:49.011126 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:49.011126 [debug] [MainThread]: On master: BEGIN
[0m17:13:49.011126 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:13:49.011126 [debug] [MainThread]: On master: COMMIT
[0m17:13:49.011126 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:49.011126 [debug] [MainThread]: On master: COMMIT
[0m17:13:49.011126 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:13:49.011126 [debug] [MainThread]: On master: Close
[0m17:13:49.019127 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:13:49.019127 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example ..................................... [RUN]
[0m17:13:49.019127 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:13:49.019127 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:13:49.027831 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:13:49.027831 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:13:49.094462 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:13:49.094462 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:13:49.094462 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:13:49.094462 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:13:49.144391 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m17:13:49.152392 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:13:49.152392 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users;
  );
[0m17:13:49.152392 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 41:     active_users;
                         ^

[0m17:13:49.152392 [debug] [Thread-1 (]: On model.my_dbt_project.example: ROLLBACK
[0m17:13:49.152392 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:13:49.161117 [debug] [Thread-1 (]: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:13:49.169119 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE040A7170>]}
[0m17:13:49.169119 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model public.example ............................ [[31mERROR[0m in 0.14s]
[0m17:13:49.169119 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:13:49.169119 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:13:49.169119 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.example' to be skipped because of status 'error'.  Reason: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql.
[0m17:13:49.169119 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:13:49.169119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:13:49.177652 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:13:49.177754 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.177754 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:13:49.219113 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.219113 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.219113 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m17:13:49.219113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:49.269846 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:13:49.269846 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.269846 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:13:49.277711 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m17:13:49.285715 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.285715 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:13:49.285715 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:13:49.285715 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.285715 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:13:49.294363 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:49.319029 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:13:49.319029 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.319029 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:13:49.327697 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:13:49.327697 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_first_dbt_model__dbt_backup"
[0m17:13:49.335697 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:13:49.335697 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "sales_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:13:49.344343 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m17:13:49.344343 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m17:13:49.344343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE7FD17770>]}
[0m17:13:49.352343 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m17:13:49.352343 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:13:49.352343 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:13:49.352343 [info ] [Thread-1 (]: 3 of 3 START sql view model public.my_second_dbt_model ......................... [RUN]
[0m17:13:49.352343 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:13:49.352343 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:13:49.362029 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.362029 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:13:49.370032 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.370032 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.370032 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m17:13:49.370032 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:13:49.427711 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:13:49.427711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.427711 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  create view "sales_db"."public"."my_second_dbt_model__dbt_tmp"
    
    
  as (
    -- Use the `ref` function to select from other models

select *
from "sales_db"."public"."my_first_dbt_model"
where id = 1
  );
[0m17:13:49.435711 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:13:49.443711 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.444370 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:13:49.444370 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:13:49.444370 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:13:49.444370 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.444370 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:13:49.452370 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:13:49.452370 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_second_dbt_model__dbt_backup"
[0m17:13:49.460989 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:13:49.460989 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop view if exists "sales_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:13:49.460989 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m17:13:49.460989 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m17:13:49.460989 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9facc345-b273-4c84-96f4-c14cb2a6ef34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE04BBDE80>]}
[0m17:13:49.460989 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.my_second_dbt_model .................... [[32mCREATE VIEW[0m in 0.11s]
[0m17:13:49.468990 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:13:49.468990 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:49.468990 [debug] [MainThread]: On master: BEGIN
[0m17:13:49.468990 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:13:49.519025 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:13:49.519025 [debug] [MainThread]: On master: COMMIT
[0m17:13:49.519025 [debug] [MainThread]: Using postgres connection "master"
[0m17:13:49.519025 [debug] [MainThread]: On master: COMMIT
[0m17:13:49.519025 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:13:49.519025 [debug] [MainThread]: On master: Close
[0m17:13:49.519025 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:13:49.527632 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:13:49.527632 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:13:49.527632 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m17:13:49.527632 [info ] [MainThread]: 
[0m17:13:49.527632 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 0.85 seconds (0.85s).
[0m17:13:49.527632 [debug] [MainThread]: Command end result
[0m17:13:49.562243 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:13:49.570243 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:13:49.577691 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:13:49.577691 [info ] [MainThread]: 
[0m17:13:49.585691 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:13:49.585691 [info ] [MainThread]: 
[0m17:13:49.585691 [error] [MainThread]:   Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 41:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:13:49.585691 [info ] [MainThread]: 
[0m17:13:49.585691 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:13:49.594423 [debug] [MainThread]: Command `dbt run` failed at 17:13:49.593691 after 2.59 seconds
[0m17:13:49.594423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02604F50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02605340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE02606420>]}
[0m17:13:49.594423 [debug] [MainThread]: Flushing usage events
[0m17:13:50.035378 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:24:29.939689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC14AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC14F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC14D10>]}


============================== 17:24:29.948221 | 352be0a0-dc11-41d7-9cdf-415bd5b97866 ==============================
[0m17:24:29.948221 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:24:29.948221 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:24:30.265810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC37050>]}
[0m17:24:30.372704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EC176840>]}
[0m17:24:30.380704 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:24:30.705974 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:24:30.864653 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:24:30.864653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EC7A86B0>]}
[0m17:24:32.564112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236E9E62060>]}
[0m17:24:32.655472 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:24:32.655472 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:24:32.697428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EE3BD760>]}
[0m17:24:32.697428 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:24:32.697428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EC122450>]}
[0m17:24:32.697428 [info ] [MainThread]: 
[0m17:24:32.697428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:24:32.705428 [info ] [MainThread]: 
[0m17:24:32.705428 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:24:32.705428 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:24:32.814051 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:24:32.814051 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:24:32.814051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:32.872068 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.058 seconds
[0m17:24:32.880704 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:24:32.880704 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:24:32.888723 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:24:32.888723 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:24:32.896722 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:24:33.038666 [debug] [ThreadPool]: SQL status: BEGIN in 0.147 seconds
[0m17:24:33.038666 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:24:33.038666 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:24:33.047325 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m17:24:33.047325 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:24:33.047325 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:24:33.055325 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.055325 [debug] [MainThread]: On master: BEGIN
[0m17:24:33.055325 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:24:33.105269 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m17:24:33.105269 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.105269 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:24:33.113947 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:24:33.121947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EE35AA50>]}
[0m17:24:33.121947 [debug] [MainThread]: On master: ROLLBACK
[0m17:24:33.121947 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.121947 [debug] [MainThread]: On master: BEGIN
[0m17:24:33.121947 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:24:33.121947 [debug] [MainThread]: On master: COMMIT
[0m17:24:33.121947 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.121947 [debug] [MainThread]: On master: COMMIT
[0m17:24:33.121947 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:24:33.121947 [debug] [MainThread]: On master: Close
[0m17:24:33.129946 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:24:33.130623 [info ] [Thread-1 (]: 1 of 3 START sql table model public.example .................................... [RUN]
[0m17:24:33.130623 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:24:33.130623 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:24:33.138624 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:24:33.138624 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:24:33.188655 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:24:33.198264 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:24:33.198264 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:24:33.198264 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:24:33.247272 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:24:33.247272 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:24:33.247272 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  
    

  create  table "sales_db"."public"."example__dbt_tmp"
  
  
    as
  
  (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users;
  );
  
[0m17:24:33.247272 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 46:     active_users;
                         ^

[0m17:24:33.247272 [debug] [Thread-1 (]: On model.my_dbt_project.example: ROLLBACK
[0m17:24:33.247272 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:24:33.255272 [debug] [Thread-1 (]: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:24:33.263931 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EE564FB0>]}
[0m17:24:33.263931 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.example ........................... [[31mERROR[0m in 0.12s]
[0m17:24:33.263931 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:24:33.263931 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:24:33.263931 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.example' to be skipped because of status 'error'.  Reason: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql.
[0m17:24:33.263931 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:24:33.263931 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:24:33.263931 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:24:33.271933 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.271933 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:24:33.280874 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.280874 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.280874 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m17:24:33.288872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:33.338602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:24:33.338602 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.338602 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:24:33.347226 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m17:24:33.355228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.355228 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:24:33.355228 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:33.355228 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.363796 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:24:33.363890 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:24:33.380561 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:24:33.388566 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.388566 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:24:33.388566 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:24:33.397331 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_first_dbt_model__dbt_backup"
[0m17:24:33.405336 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:24:33.405336 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "sales_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:24:33.405336 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:24:33.413858 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m17:24:33.413858 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EA047620>]}
[0m17:24:33.413858 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.15s]
[0m17:24:33.413858 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:24:33.413858 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:24:33.421861 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m17:24:33.421861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:24:33.421861 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:24:33.421861 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.421861 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:24:33.432079 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.432079 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.432079 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m17:24:33.432079 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:24:33.488537 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m17:24:33.488537 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.488537 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "sales_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m17:24:33.488537 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:24:33.497176 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.497176 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:24:33.497176 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:24:33.505176 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:24:33.505176 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.505176 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:24:33.505176 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:24:33.514016 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_second_dbt_model__dbt_backup"
[0m17:24:33.514016 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:24:33.514016 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop table if exists "sales_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:24:33.514016 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:24:33.514016 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m17:24:33.514016 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '352be0a0-dc11-41d7-9cdf-415bd5b97866', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EE8D3E90>]}
[0m17:24:33.522016 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.09s]
[0m17:24:33.522016 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:24:33.522016 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.522016 [debug] [MainThread]: On master: BEGIN
[0m17:24:33.522016 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:24:33.588537 [debug] [MainThread]: SQL status: BEGIN in 0.060 seconds
[0m17:24:33.588537 [debug] [MainThread]: On master: COMMIT
[0m17:24:33.588537 [debug] [MainThread]: Using postgres connection "master"
[0m17:24:33.588537 [debug] [MainThread]: On master: COMMIT
[0m17:24:33.588537 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:24:33.588537 [debug] [MainThread]: On master: Close
[0m17:24:33.588537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:24:33.588537 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:24:33.588537 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:24:33.588537 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m17:24:33.596534 [info ] [MainThread]: 
[0m17:24:33.597163 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m17:24:33.597163 [debug] [MainThread]: Command end result
[0m17:24:33.631707 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:24:33.639708 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:24:33.655221 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:24:33.655221 [info ] [MainThread]: 
[0m17:24:33.655221 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:24:33.655221 [info ] [MainThread]: 
[0m17:24:33.655221 [error] [MainThread]:   Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:24:33.655221 [info ] [MainThread]: 
[0m17:24:33.655221 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:24:33.664002 [debug] [MainThread]: Command `dbt run` failed at 17:24:33.664002 after 3.95 seconds
[0m17:24:33.664002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC5BAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236EC14C350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000236ECC14D10>]}
[0m17:24:33.664002 [debug] [MainThread]: Flushing usage events
[0m17:24:34.096944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:49.767166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A954A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A954EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A954DD0>]}


============================== 17:25:49.776450 | 0fbd5701-9806-4b68-b335-1802957fe1b9 ==============================
[0m17:25:49.776450 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:25:49.776450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt clean', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:49.975879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0fbd5701-9806-4b68-b335-1802957fe1b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A977290>]}
[0m17:25:50.009158 [debug] [MainThread]: Command `dbt clean` succeeded at 17:25:50.009158 after 0.42 seconds
[0m17:25:50.009158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A7074D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661A5C4A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002661ABD6270>]}
[0m17:25:50.009158 [debug] [MainThread]: Flushing usage events
[0m17:25:50.475537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:25:53.882678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F3237680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F60846B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F60846E0>]}


============================== 17:25:53.882678 | 71b2d7fa-75d0-4504-abeb-7a82711ebb1e ==============================
[0m17:25:53.882678 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:25:53.891507 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt compile', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:25:54.225019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F6104A10>]}
[0m17:25:54.333072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F6118E00>]}
[0m17:25:54.333072 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:25:54.657819 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:25:54.657819 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:25:54.657819 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F5E08F50>]}
[0m17:25:56.398635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F7784920>]}
[0m17:25:56.498615 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:25:56.515387 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:25:56.548617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F7785A30>]}
[0m17:25:56.548617 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:25:56.548617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F7798110>]}
[0m17:25:56.548617 [info ] [MainThread]: 
[0m17:25:56.548617 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:56.548617 [info ] [MainThread]: 
[0m17:25:56.556617 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:25:56.557261 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:25:56.657952 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:25:56.657952 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:25:56.657952 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:56.715253 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m17:25:56.715253 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:25:56.715253 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:25:56.724041 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.007 seconds
[0m17:25:56.724041 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:25:56.732042 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:25:56.740549 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:56.740549 [debug] [MainThread]: On master: BEGIN
[0m17:25:56.740549 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:56.781867 [debug] [MainThread]: SQL status: BEGIN in 0.044 seconds
[0m17:25:56.781867 [debug] [MainThread]: Using postgres connection "master"
[0m17:25:56.781867 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:25:56.790670 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:25:56.798670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71b2d7fa-75d0-4504-abeb-7a82711ebb1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F3561370>]}
[0m17:25:56.798670 [debug] [MainThread]: On master: ROLLBACK
[0m17:25:56.798670 [debug] [MainThread]: On master: Close
[0m17:25:56.807200 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:25:56.807200 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:25:56.807200 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:25:56.815202 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:25:56.815202 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:25:56.815202 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:25:56.823200 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:25:56.824016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:25:56.824016 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:25:56.832017 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:25:56.832017 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:25:56.832017 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:25:56.832017 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:25:56.832017 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:25:56.840015 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:25:56.840522 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:25:56.840522 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:25:56.840522 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:25:56.840522 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:25:56.840522 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_second_dbt_model, now test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:25:56.848525 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:25:56.865769 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:25:56.865769 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:25:56.865769 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:25:56.865769 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m17:25:56.873818 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_my_first_dbt_model_id.5fb22c2710, now test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321)
[0m17:25:56.873818 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m17:25:56.881819 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321"
[0m17:25:56.881819 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m17:25:56.881819 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321
[0m17:25:56.881819 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:25:56.881819 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_my_first_dbt_model_id.16e066b321, now test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778)
[0m17:25:56.881819 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:25:56.891030 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778"
[0m17:25:56.891030 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:25:56.891030 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778
[0m17:25:56.891030 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:25:56.891030 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_my_second_dbt_model_id.151b76d778, now test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493)
[0m17:25:56.899031 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:25:56.899031 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493"
[0m17:25:56.907305 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:25:56.907305 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493
[0m17:25:56.907305 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:56.907305 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:25:56.907305 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m17:25:56.907305 [debug] [MainThread]: Command end result
[0m17:25:56.931831 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:25:56.941045 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:25:56.949049 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:25:56.949049 [debug] [MainThread]: Command `dbt compile` succeeded at 17:25:56.949049 after 3.22 seconds
[0m17:25:56.949049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F6084860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F6084770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B9F60846E0>]}
[0m17:25:56.949049 [debug] [MainThread]: Flushing usage events
[0m17:25:57.381626 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:26:00.889540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002810087C6B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281007701A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281007720C0>]}


============================== 17:26:00.889540 | fcfbe279-c088-444c-85aa-7c8f5c0b5e66 ==============================
[0m17:26:00.889540 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:26:00.897541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:26:01.222563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002810034F890>]}
[0m17:26:01.339426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028100FC8F20>]}
[0m17:26:01.347427 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:26:01.673038 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:26:01.863888 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:26:01.863888 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:26:01.922448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028102278590>]}
[0m17:26:02.013907 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:26:02.013907 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:26:02.047044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028102455520>]}
[0m17:26:02.055045 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:26:02.055766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002810241A660>]}
[0m17:26:02.055766 [info ] [MainThread]: 
[0m17:26:02.055766 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:26:02.055766 [info ] [MainThread]: 
[0m17:26:02.055766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:26:02.063765 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:26:02.172349 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:26:02.172349 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:26:02.172349 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:02.230326 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m17:26:02.230326 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:26:02.230326 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:26:02.246992 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:26:02.246992 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:26:02.246992 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:26:02.296999 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m17:26:02.296999 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:26:02.296999 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:26:02.305825 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m17:26:02.305825 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:26:02.313825 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:26:02.321826 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.322304 [debug] [MainThread]: On master: BEGIN
[0m17:26:02.322304 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:26:02.364187 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:26:02.364187 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.364187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:26:02.380323 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:26:02.380323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281011391C0>]}
[0m17:26:02.380323 [debug] [MainThread]: On master: ROLLBACK
[0m17:26:02.380323 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.380323 [debug] [MainThread]: On master: BEGIN
[0m17:26:02.380323 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:26:02.380323 [debug] [MainThread]: On master: COMMIT
[0m17:26:02.380323 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.388324 [debug] [MainThread]: On master: COMMIT
[0m17:26:02.388949 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:26:02.388949 [debug] [MainThread]: On master: Close
[0m17:26:02.388949 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:26:02.388949 [info ] [Thread-1 (]: 1 of 3 START sql table model public.example .................................... [RUN]
[0m17:26:02.388949 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:26:02.388949 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:26:02.406813 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:26:02.406813 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:26:02.480242 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:26:02.480242 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:26:02.480242 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:26:02.480242 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:26:02.530243 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:26:02.530243 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:26:02.530243 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  
    

  create  table "sales_db"."public"."example__dbt_tmp"
  
  
    as
  
  (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users;
  );
  
[0m17:26:02.530243 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 46:     active_users;
                         ^

[0m17:26:02.530243 [debug] [Thread-1 (]: On model.my_dbt_project.example: ROLLBACK
[0m17:26:02.530243 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:26:02.547126 [debug] [Thread-1 (]: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:26:02.547126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028100311430>]}
[0m17:26:02.547126 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model public.example ........................... [[31mERROR[0m in 0.16s]
[0m17:26:02.547126 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:26:02.547126 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:26:02.555127 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.example' to be skipped because of status 'error'.  Reason: Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql.
[0m17:26:02.555630 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:26:02.555630 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:26:02.555630 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:26:02.563632 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.563632 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:26:02.563632 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.563632 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.572350 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m17:26:02.572350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:02.630220 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:26:02.630220 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.630220 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:26:02.638218 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.005 seconds
[0m17:26:02.646886 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.646886 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:26:02.654886 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:26:02.655668 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.655668 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:26:02.663670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:26:02.706203 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:26:02.706203 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.706203 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:26:02.706203 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:26:02.714203 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_first_dbt_model__dbt_backup"
[0m17:26:02.722733 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:26:02.722733 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "sales_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:26:02.730734 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:26:02.730734 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m17:26:02.730734 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002817E1C7800>]}
[0m17:26:02.730734 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.18s]
[0m17:26:02.738907 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:26:02.738907 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:26:02.738907 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m17:26:02.738907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:26:02.738907 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:26:02.746908 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.746908 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:26:02.746908 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.746908 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.755683 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m17:26:02.755683 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:02.805469 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m17:26:02.805469 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.805469 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "sales_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m17:26:02.813476 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m17:26:02.813476 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.821469 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m17:26:02.822165 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:26:02.822165 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.822165 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:26:02.830167 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:26:02.830167 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:26:02.830167 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.830167 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:26:02.830167 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:26:02.838812 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_second_dbt_model__dbt_backup"
[0m17:26:02.838812 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:26:02.838812 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop table if exists "sales_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:26:02.846813 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:26:02.846813 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m17:26:02.846813 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fcfbe279-c088-444c-85aa-7c8f5c0b5e66', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000281010CE030>]}
[0m17:26:02.846813 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.11s]
[0m17:26:02.846813 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:26:02.855602 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.855602 [debug] [MainThread]: On master: BEGIN
[0m17:26:02.855602 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:02.913448 [debug] [MainThread]: SQL status: BEGIN in 0.059 seconds
[0m17:26:02.913448 [debug] [MainThread]: On master: COMMIT
[0m17:26:02.913448 [debug] [MainThread]: Using postgres connection "master"
[0m17:26:02.913448 [debug] [MainThread]: On master: COMMIT
[0m17:26:02.913448 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:26:02.913448 [debug] [MainThread]: On master: Close
[0m17:26:02.922137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:02.922137 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:26:02.922137 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:26:02.922137 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m17:26:02.922137 [info ] [MainThread]: 
[0m17:26:02.922137 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m17:26:02.922137 [debug] [MainThread]: Command end result
[0m17:26:02.955522 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:26:02.963523 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:26:02.972165 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:26:02.972165 [info ] [MainThread]: 
[0m17:26:02.972165 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:26:02.980165 [info ] [MainThread]: 
[0m17:26:02.980165 [error] [MainThread]:   Database Error in model example (models\example.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 46:     active_users;
                           ^
  compiled code at target\run\my_dbt_project\models\example.sql
[0m17:26:02.980165 [info ] [MainThread]: 
[0m17:26:02.980165 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m17:26:02.980165 [debug] [MainThread]: Command `dbt run` failed at 17:26:02.980165 after 2.26 seconds
[0m17:26:02.980165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028100E449E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028100E44A40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028100E45B80>]}
[0m17:26:02.980165 [debug] [MainThread]: Flushing usage events
[0m17:26:03.404718 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:27:02.647717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC6C4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC6C4830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC6C4710>]}


============================== 17:27:02.655578 | cd019c44-1e06-4a51-989c-f66e41ce6295 ==============================
[0m17:27:02.655578 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:27:02.655578 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:27:03.013293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC87D250>]}
[0m17:27:03.113241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FBBD27E0>]}
[0m17:27:03.113241 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:27:03.463197 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:27:03.663080 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:27:03.663080 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\example.sql
[0m17:27:04.112973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FDEA9250>]}
[0m17:27:04.197726 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:27:04.205008 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:27:04.238293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FDE6B650>]}
[0m17:27:04.238293 [info ] [MainThread]: Found 3 models, 4 data tests, 431 macros
[0m17:27:04.238293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FDDA4B30>]}
[0m17:27:04.246292 [info ] [MainThread]: 
[0m17:27:04.246292 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:27:04.246292 [info ] [MainThread]: 
[0m17:27:04.246292 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:27:04.255102 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:27:04.346184 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:27:04.346184 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:27:04.346184 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:04.404918 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.053 seconds
[0m17:27:04.404918 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:27:04.404918 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:27:04.421595 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:27:04.421595 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:27:04.421595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:04.471576 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:27:04.471576 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:27:04.471576 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:27:04.479576 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m17:27:04.479576 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:27:04.479576 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:27:04.488236 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.488236 [debug] [MainThread]: On master: BEGIN
[0m17:27:04.488236 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:27:04.538225 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:27:04.538225 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.538225 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:27:04.546226 [debug] [MainThread]: SQL status: SELECT 0 in 0.007 seconds
[0m17:27:04.546226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC87CAD0>]}
[0m17:27:04.546226 [debug] [MainThread]: On master: ROLLBACK
[0m17:27:04.546226 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.546226 [debug] [MainThread]: On master: BEGIN
[0m17:27:04.546226 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:27:04.554227 [debug] [MainThread]: On master: COMMIT
[0m17:27:04.554859 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:04.554859 [debug] [MainThread]: On master: COMMIT
[0m17:27:04.554859 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:04.554859 [debug] [MainThread]: On master: Close
[0m17:27:04.554859 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:27:04.554859 [info ] [Thread-1 (]: 1 of 3 START sql table model public.example .................................... [RUN]
[0m17:27:04.554859 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:27:04.562861 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:27:04.572968 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:27:04.572968 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:27:04.629551 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:27:04.638217 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:27:04.638217 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:27:04.638217 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:27:04.679480 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:27:04.688170 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:27:04.688170 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  
    

  create  table "sales_db"."public"."example__dbt_tmp"
  
  
    as
  
  (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
  
[0m17:27:04.688170 [debug] [Thread-1 (]: SQL status: SELECT 81 in 0.005 seconds
[0m17:27:04.696171 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:27:04.696171 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m17:27:04.696171 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:27:04.721637 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:27:04.729637 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:27:04.729637 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:27:04.729637 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:27:04.738250 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m17:27:04.746252 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:27:04.746252 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop table if exists "sales_db"."public"."example__dbt_backup" cascade
[0m17:27:04.746252 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:27:04.746252 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:27:04.754250 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FE433410>]}
[0m17:27:04.754815 [info ] [Thread-1 (]: 1 of 3 OK created sql table model public.example ............................... [[32mSELECT 81[0m in 0.19s]
[0m17:27:04.754815 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:27:04.754815 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_first_dbt_model
[0m17:27:04.754815 [info ] [Thread-1 (]: 2 of 3 START sql table model public.my_first_dbt_model ......................... [RUN]
[0m17:27:04.754815 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.my_first_dbt_model)
[0m17:27:04.762815 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_first_dbt_model
[0m17:27:04.762815 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.762815 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_first_dbt_model
[0m17:27:04.771529 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.771529 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.771529 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: BEGIN
[0m17:27:04.771529 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:04.821502 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:27:04.821502 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.821502 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_first_dbt_model__dbt_tmp"
  
  
    as
  
  (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
  
[0m17:27:04.821502 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.004 seconds
[0m17:27:04.829505 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.829505 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m17:27:04.829505 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:27:04.838106 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.838106 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
alter table "sales_db"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m17:27:04.838106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:04.846107 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:27:04.846107 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.846107 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: COMMIT
[0m17:27:04.854123 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:27:04.854767 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_first_dbt_model__dbt_backup"
[0m17:27:04.854767 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_first_dbt_model"
[0m17:27:04.854767 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_first_dbt_model"} */
drop table if exists "sales_db"."public"."my_first_dbt_model__dbt_backup" cascade
[0m17:27:04.862767 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:27:04.862767 [debug] [Thread-1 (]: On model.my_dbt_project.my_first_dbt_model: Close
[0m17:27:04.862767 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FE4333B0>]}
[0m17:27:04.862767 [info ] [Thread-1 (]: 2 of 3 OK created sql table model public.my_first_dbt_model .................... [[32mSELECT 2[0m in 0.11s]
[0m17:27:04.862767 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_first_dbt_model
[0m17:27:04.870770 [debug] [Thread-1 (]: Began running node model.my_dbt_project.my_second_dbt_model
[0m17:27:04.871503 [info ] [Thread-1 (]: 3 of 3 START sql table model public.my_second_dbt_model ........................ [RUN]
[0m17:27:04.871503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.my_first_dbt_model, now model.my_dbt_project.my_second_dbt_model)
[0m17:27:04.871503 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.my_second_dbt_model
[0m17:27:04.879522 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.879522 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.my_second_dbt_model
[0m17:27:04.888194 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.888194 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.888194 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: BEGIN
[0m17:27:04.888194 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:04.954795 [debug] [Thread-1 (]: SQL status: BEGIN in 0.066 seconds
[0m17:27:04.954795 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.954795 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */

  
    

  create  table "sales_db"."public"."my_second_dbt_model__dbt_tmp"
  
  
    as
  
  (
    -- Use the `ref` function to select from other models

select *
from "sales_db"."public"."my_first_dbt_model"
where id = 1
  );
  
[0m17:27:04.962795 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m17:27:04.971455 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.971455 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m17:27:04.979455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:04.988104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.988104 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
alter table "sales_db"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m17:27:04.988104 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:27:04.988104 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:27:04.988104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:04.996103 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: COMMIT
[0m17:27:04.996103 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:27:05.004741 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."my_second_dbt_model__dbt_backup"
[0m17:27:05.004741 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.my_second_dbt_model"
[0m17:27:05.004741 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.my_second_dbt_model"} */
drop table if exists "sales_db"."public"."my_second_dbt_model__dbt_backup" cascade
[0m17:27:05.004741 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.002 seconds
[0m17:27:05.004741 [debug] [Thread-1 (]: On model.my_dbt_project.my_second_dbt_model: Close
[0m17:27:05.012742 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cd019c44-1e06-4a51-989c-f66e41ce6295', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FE4336E0>]}
[0m17:27:05.012742 [info ] [Thread-1 (]: 3 of 3 OK created sql table model public.my_second_dbt_model ................... [[32mSELECT 1[0m in 0.14s]
[0m17:27:05.012742 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.my_second_dbt_model
[0m17:27:05.012742 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:05.012742 [debug] [MainThread]: On master: BEGIN
[0m17:27:05.012742 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:27:05.062727 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:27:05.062727 [debug] [MainThread]: On master: COMMIT
[0m17:27:05.062727 [debug] [MainThread]: Using postgres connection "master"
[0m17:27:05.062727 [debug] [MainThread]: On master: COMMIT
[0m17:27:05.062727 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:27:05.062727 [debug] [MainThread]: On master: Close
[0m17:27:05.071377 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:05.071377 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:27:05.071377 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:27:05.071377 [debug] [MainThread]: Connection 'model.my_dbt_project.my_second_dbt_model' was properly closed.
[0m17:27:05.071377 [info ] [MainThread]: 
[0m17:27:05.071377 [info ] [MainThread]: Finished running 3 table models in 0 hours 0 minutes and 0.83 seconds (0.83s).
[0m17:27:05.071377 [debug] [MainThread]: Command end result
[0m17:27:05.096366 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:27:05.096366 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:27:05.105868 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:27:05.105868 [info ] [MainThread]: 
[0m17:27:05.113867 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:05.113867 [info ] [MainThread]: 
[0m17:27:05.113867 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:27:05.113867 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:05.113867 after 2.64 seconds
[0m17:27:05.113867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FC9A66C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FDBCB170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B2FDBEBFB0>]}
[0m17:27:05.113867 [debug] [MainThread]: Flushing usage events
[0m17:27:05.562672 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:38:51.490726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022950928D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295092AFF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295092A270>]}


============================== 17:38:51.498727 | 93bfaa54-8c4d-4daf-bf68-1869a8d4128b ==============================
[0m17:38:51.498727 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:38:51.498727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:38:51.806752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022950C7F380>]}
[0m17:38:51.915181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229508B2450>]}
[0m17:38:51.915181 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:38:52.239878 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:38:52.447812 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 1 files added, 0 files changed.
[0m17:38:52.455811 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://seeds\schema.yaml
[0m17:38:52.456455 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\example\my_first_dbt_model.sql
[0m17:38:52.456455 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\example\my_second_dbt_model.sql
[0m17:38:52.814395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229523F0350>]}
[0m17:38:52.897700 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:38:52.905696 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:38:52.956359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295290D760>]}
[0m17:38:52.956359 [info ] [MainThread]: Found 1 model, 3 data tests, 431 macros
[0m17:38:52.956359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295247FA10>]}
[0m17:38:52.964361 [info ] [MainThread]: 
[0m17:38:52.964361 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:38:52.964361 [info ] [MainThread]: 
[0m17:38:52.964361 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:38:52.973147 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:38:53.064306 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:38:53.064306 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:38:53.073119 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:53.122950 [debug] [ThreadPool]: SQL status: BEGIN in 0.053 seconds
[0m17:38:53.122950 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:38:53.122950 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:38:53.130950 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m17:38:53.130950 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:38:53.130950 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:38:53.139640 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.139640 [debug] [MainThread]: On master: BEGIN
[0m17:38:53.139640 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:53.190811 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:38:53.190811 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.190811 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:38:53.198814 [debug] [MainThread]: SQL status: SELECT 0 in 0.008 seconds
[0m17:38:53.206306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '93bfaa54-8c4d-4daf-bf68-1869a8d4128b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295290E510>]}
[0m17:38:53.206306 [debug] [MainThread]: On master: ROLLBACK
[0m17:38:53.206306 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.206306 [debug] [MainThread]: On master: BEGIN
[0m17:38:53.206306 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:38:53.206306 [debug] [MainThread]: On master: COMMIT
[0m17:38:53.206306 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.206306 [debug] [MainThread]: On master: COMMIT
[0m17:38:53.206306 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:53.214306 [debug] [MainThread]: On master: Close
[0m17:38:53.214306 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:38:53.214306 [info ] [Thread-1 (]: 1 of 3 START test not_null_example_email ....................................... [RUN]
[0m17:38:53.214306 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_example_email.f6780dacc6'
[0m17:38:53.214306 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:38:53.239616 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:38:53.247617 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:38:53.265122 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:38:53.265122 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:38:53.272934 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: BEGIN
[0m17:38:53.272934 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:38:53.322940 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:38:53.322940 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:38:53.322940 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_email.f6780dacc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "sales_db"."public"."example"
where email is null



      
    ) dbt_internal_test
[0m17:38:53.322940 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:38:53.330943 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: ROLLBACK
[0m17:38:53.330943 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: Close
[0m17:38:53.330943 [info ] [Thread-1 (]: 1 of 3 PASS not_null_example_email ............................................. [[32mPASS[0m in 0.12s]
[0m17:38:53.339922 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:38:53.339922 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:38:53.339922 [info ] [Thread-1 (]: 2 of 3 START test not_null_example_id .......................................... [RUN]
[0m17:38:53.339922 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m17:38:53.339922 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:38:53.347924 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:38:53.347924 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:38:53.357761 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:38:53.357761 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:38:53.357761 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: BEGIN
[0m17:38:53.357761 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:53.406214 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m17:38:53.406214 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:38:53.406214 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_id.96691fbe5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sales_db"."public"."example"
where id is null



      
    ) dbt_internal_test
[0m17:38:53.414214 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.001 seconds
[0m17:38:53.414214 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: ROLLBACK
[0m17:38:53.414214 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: Close
[0m17:38:53.414214 [info ] [Thread-1 (]: 2 of 3 PASS not_null_example_id ................................................ [[32mPASS[0m in 0.07s]
[0m17:38:53.414214 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:38:53.422214 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:38:53.423012 [info ] [Thread-1 (]: 3 of 3 START test unique_example_id ............................................ [RUN]
[0m17:38:53.423012 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m17:38:53.423012 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:38:53.431012 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:38:53.431012 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:38:53.439636 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:38:53.439636 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:38:53.439636 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: BEGIN
[0m17:38:53.439636 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:53.489534 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m17:38:53.489534 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:38:53.489534 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_example_id.50f543cf6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sales_db"."public"."example"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:38:53.497534 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:38:53.497534 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: ROLLBACK
[0m17:38:53.497534 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: Close
[0m17:38:53.497534 [info ] [Thread-1 (]: 3 of 3 PASS unique_example_id .................................................. [[32mPASS[0m in 0.07s]
[0m17:38:53.505535 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:38:53.506258 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.506258 [debug] [MainThread]: On master: BEGIN
[0m17:38:53.506258 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:53.556211 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:38:53.556211 [debug] [MainThread]: On master: COMMIT
[0m17:38:53.556211 [debug] [MainThread]: Using postgres connection "master"
[0m17:38:53.556211 [debug] [MainThread]: On master: COMMIT
[0m17:38:53.556211 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:38:53.556211 [debug] [MainThread]: On master: Close
[0m17:38:53.556211 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:53.556211 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:38:53.564211 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_example_id.50f543cf6e' was properly closed.
[0m17:38:53.564211 [info ] [MainThread]: 
[0m17:38:53.564211 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m17:38:53.564211 [debug] [MainThread]: Command end result
[0m17:38:53.589595 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:38:53.597596 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:38:53.606209 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:38:53.606209 [info ] [MainThread]: 
[0m17:38:53.606209 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:53.606209 [info ] [MainThread]: 
[0m17:38:53.614231 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:38:53.614231 [debug] [MainThread]: Command `dbt test` succeeded at 17:38:53.614231 after 2.33 seconds
[0m17:38:53.614231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002295098FB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229507A3C80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000229507A09B0>]}
[0m17:38:53.614231 [debug] [MainThread]: Flushing usage events
[0m17:38:54.056089 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:08.809769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D2A51250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D56394F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D51ED700>]}


============================== 17:39:08.820201 | 25a82809-383a-4251-b536-d33891cc5593 ==============================
[0m17:39:08.820201 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:39:08.820201 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs generate', 'send_anonymous_usage_stats': 'True'}
[0m17:39:09.176354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4C86780>]}
[0m17:39:09.303054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D4C337A0>]}
[0m17:39:09.305660 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:39:09.673654 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:39:09.918288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:39:09.918288 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:39:09.977383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D5ACB8C0>]}
[0m17:39:10.018317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D6DC25A0>]}
[0m17:39:10.018317 [info ] [MainThread]: Found 1 model, 3 data tests, 431 macros
[0m17:39:10.018317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D6D82B70>]}
[0m17:39:10.018317 [info ] [MainThread]: 
[0m17:39:10.018317 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:39:10.026317 [info ] [MainThread]: 
[0m17:39:10.026317 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:39:10.026317 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:39:10.134913 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:39:10.134913 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:39:10.134913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:10.186214 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m17:39:10.194216 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:39:10.194216 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:39:10.202214 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.008 seconds
[0m17:39:10.202214 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:39:10.202214 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:39:10.210213 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:10.218197 [debug] [MainThread]: On master: BEGIN
[0m17:39:10.218197 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:39:10.270243 [debug] [MainThread]: SQL status: BEGIN in 0.058 seconds
[0m17:39:10.278244 [debug] [MainThread]: Using postgres connection "master"
[0m17:39:10.278244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:39:10.284863 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m17:39:10.284863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25a82809-383a-4251-b536-d33891cc5593', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D6C4A1E0>]}
[0m17:39:10.292862 [debug] [MainThread]: On master: ROLLBACK
[0m17:39:10.292862 [debug] [MainThread]: On master: Close
[0m17:39:10.292862 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:39:10.292862 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:39:10.292862 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:39:10.309603 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:39:10.309603 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:39:10.317601 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:39:10.318195 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:39:10.318195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now test.my_dbt_project.not_null_example_email.f6780dacc6)
[0m17:39:10.318195 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:39:10.334813 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:39:10.334813 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:39:10.334813 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:39:10.342814 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:39:10.342814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m17:39:10.342814 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:39:10.342814 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:39:10.350813 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:39:10.351538 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:39:10.351538 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:39:10.351538 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m17:39:10.351538 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:39:10.359539 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:39:10.368206 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:39:10.368206 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:39:10.368206 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:39:10.368206 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:39:10.368206 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_example_id.50f543cf6e' was properly closed.
[0m17:39:10.368206 [debug] [MainThread]: Command end result
[0m17:39:10.468225 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:39:10.476225 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:39:10.492874 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:39:10.934756 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:39:10.934756 [info ] [MainThread]: Building catalog
[0m17:39:10.942758 [debug] [ThreadPool]: Acquiring new postgres connection 'sales_db.information_schema'
[0m17:39:10.952653 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m17:39:10.952653 [debug] [ThreadPool]: On sales_db.information_schema: BEGIN
[0m17:39:10.960655 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:39:11.117955 [debug] [ThreadPool]: SQL status: BEGIN in 0.162 seconds
[0m17:39:11.117955 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m17:39:11.117955 [debug] [ThreadPool]: On sales_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "sales_db.information_schema"} */

    
    

    select
        'sales_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('example')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:39:11.134913 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m17:39:11.142913 [debug] [ThreadPool]: On sales_db.information_schema: ROLLBACK
[0m17:39:11.142913 [debug] [ThreadPool]: On sales_db.information_schema: Close
[0m17:39:11.168135 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m17:39:11.192134 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:39:11.200133 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:39:11.200133 [info ] [MainThread]: Catalog written to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m17:39:11.200133 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:39:11.200133 after 2.57 seconds
[0m17:39:11.208133 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:39:11.208133 [debug] [MainThread]: Connection 'sales_db.information_schema' was properly closed.
[0m17:39:11.208133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D576BB90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D544FA70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000184D2A51250>]}
[0m17:39:11.208133 [debug] [MainThread]: Flushing usage events
[0m17:39:11.649918 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:39:17.169731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E7D6D7470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E7E2DBB60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E00CD8F20>]}


============================== 17:39:17.177818 | b1c4530a-f087-455c-b9b2-2e8bd991c7b8 ==============================
[0m17:39:17.177818 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:39:17.184316 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:39:17.516097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1c4530a-f087-455c-b9b2-2e8bd991c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E0053C290>]}
[0m17:39:17.632748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1c4530a-f087-455c-b9b2-2e8bd991c7b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E007A3230>]}
[0m17:49:51.720996 [error] [MainThread]: Encountered an error:

[0m17:49:51.755647 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m17:49:51.755647 [debug] [MainThread]: Command `dbt docs serve` failed at 17:49:51.755647 after 634.76 seconds
[0m17:49:51.755647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E000DFDA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E00653AD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016E00EAA600>]}
[0m17:49:51.755647 [debug] [MainThread]: Flushing usage events
[0m17:49:52.221950 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:50:00.269835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176264C79E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017623FCF530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176266CA0C0>]}


============================== 17:50:00.269835 | b6cb7e75-db30-4947-afac-16b121537323 ==============================
[0m17:50:00.269835 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:50:00.269835 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:50:00.652959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017626E3C800>]}
[0m17:50:00.769686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762685DD30>]}
[0m17:50:00.769686 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:50:01.186297 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:50:01.419373 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 2 files added, 0 files changed.
[0m17:50:01.435780 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\schema.yaml
[0m17:50:01.436232 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\example.sql
[0m17:50:01.436232 [debug] [MainThread]: Partial parsing: deleted file: my_dbt_project://models\example.sql
[0m17:50:02.619221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m17:50:02.635998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762847F3E0>]}
[0m17:50:02.769105 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:50:02.769105 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:50:02.802618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017628843A40>]}
[0m17:50:02.802618 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 431 macros
[0m17:50:02.802618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176287EBBF0>]}
[0m17:50:02.802618 [info ] [MainThread]: 
[0m17:50:02.802618 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:50:02.802618 [info ] [MainThread]: 
[0m17:50:02.818243 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:50:02.819220 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:50:02.935811 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:50:02.935811 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:50:02.935811 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:02.985738 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m17:50:02.985738 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:50:02.985738 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:50:03.002480 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:50:03.002480 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:50:03.002480 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:50:03.052001 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m17:50:03.052577 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:50:03.052577 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:50:03.052577 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.006 seconds
[0m17:50:03.052577 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:50:03.052577 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:50:03.069091 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.069091 [debug] [MainThread]: On master: BEGIN
[0m17:50:03.069091 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:50:03.119126 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m17:50:03.119126 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.119126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:50:03.119126 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m17:50:03.135229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017628C894C0>]}
[0m17:50:03.135821 [debug] [MainThread]: On master: ROLLBACK
[0m17:50:03.135821 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.135821 [debug] [MainThread]: On master: BEGIN
[0m17:50:03.135821 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:50:03.135821 [debug] [MainThread]: On master: COMMIT
[0m17:50:03.135821 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.135821 [debug] [MainThread]: On master: COMMIT
[0m17:50:03.135821 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:03.135821 [debug] [MainThread]: On master: Close
[0m17:50:03.135821 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:50:03.135821 [info ] [Thread-1 (]: 1 of 1 START sql view model public.example ..................................... [RUN]
[0m17:50:03.135821 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:50:03.135821 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:50:03.152563 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:50:03.152563 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:50:03.218962 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:50:03.218962 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.218962 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:50:03.218962 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:50:03.285574 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m17:50:03.285574 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.285574 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m17:50:03.285574 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m17:50:03.302398 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.302398 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m17:50:03.302398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:50:03.302398 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.302398 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m17:50:03.302398 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:50:03.319042 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:50:03.319042 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.319042 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:50:03.335609 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:50:03.335609 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m17:50:03.335609 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:50:03.335609 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop table if exists "sales_db"."public"."example__dbt_backup" cascade
[0m17:50:03.352385 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:50:03.352385 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:50:03.352385 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6cb7e75-db30-4947-afac-16b121537323', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000176241E74A0>]}
[0m17:50:03.352385 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m17:50:03.352385 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:50:03.352385 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.352385 [debug] [MainThread]: On master: BEGIN
[0m17:50:03.352385 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:50:03.402366 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m17:50:03.402366 [debug] [MainThread]: On master: COMMIT
[0m17:50:03.402366 [debug] [MainThread]: Using postgres connection "master"
[0m17:50:03.402366 [debug] [MainThread]: On master: COMMIT
[0m17:50:03.402366 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:50:03.402366 [debug] [MainThread]: On master: Close
[0m17:50:03.402366 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:50:03.402366 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:50:03.402366 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:50:03.402366 [debug] [MainThread]: Connection 'model.my_dbt_project.example' was properly closed.
[0m17:50:03.417991 [info ] [MainThread]: 
[0m17:50:03.419118 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m17:50:03.419118 [debug] [MainThread]: Command end result
[0m17:50:03.535520 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:50:03.535520 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:50:03.535520 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:50:03.535520 [info ] [MainThread]: 
[0m17:50:03.535520 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:50:03.552545 [info ] [MainThread]: 
[0m17:50:03.552545 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:50:03.552545 [debug] [MainThread]: Command `dbt run` succeeded at 17:50:03.552545 after 3.51 seconds
[0m17:50:03.552545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762453ED80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017626C78380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001762649AF30>]}
[0m17:50:03.552545 [debug] [MainThread]: Flushing usage events
[0m17:50:03.952239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:13.292004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B930E0EF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B92FCF3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B93406BD0>]}


============================== 17:53:13.292004 | 001dbcd6-6618-4f5f-9d62-cb85611923ae ==============================
[0m17:53:13.292004 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:53:13.292004 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:53:13.675166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B95E38920>]}
[0m17:53:13.791824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B95F46D80>]}
[0m17:53:13.791824 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:14.374853 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:53:14.674702 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:14.674702 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:14.691572 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m17:53:14.758178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B973CBE00>]}
[0m17:53:14.874853 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:14.908092 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:15.108255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B977E5490>]}
[0m17:53:15.108255 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 431 macros
[0m17:53:15.108255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B97221310>]}
[0m17:53:15.141483 [info ] [MainThread]: 
[0m17:53:15.141483 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:15.141483 [info ] [MainThread]: 
[0m17:53:15.141483 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:15.174810 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:53:15.407722 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:15.423349 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:53:15.424537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:15.474661 [debug] [ThreadPool]: SQL status: BEGIN in 0.065 seconds
[0m17:53:15.491448 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:15.491448 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:53:15.491448 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m17:53:15.491448 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:53:15.491448 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:53:15.508009 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:15.508009 [debug] [MainThread]: On master: BEGIN
[0m17:53:15.508009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:15.557972 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m17:53:15.557972 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:15.557972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:15.574591 [debug] [MainThread]: SQL status: SELECT 1 in 0.009 seconds
[0m17:53:15.574591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '001dbcd6-6618-4f5f-9d62-cb85611923ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9779F680>]}
[0m17:53:15.574591 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:15.574591 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:15.574591 [debug] [MainThread]: On master: BEGIN
[0m17:53:15.574591 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:53:15.574591 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.574591 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:15.574591 [debug] [MainThread]: On master: COMMIT
[0m17:53:15.574591 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:15.574591 [debug] [MainThread]: On master: Close
[0m17:53:15.590845 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:15.591278 [info ] [Thread-1 (]: 1 of 3 START test not_null_example_email ....................................... [RUN]
[0m17:53:15.591278 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_example_email.f6780dacc6'
[0m17:53:15.591278 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:15.608131 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:53:15.608131 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:15.624739 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:53:15.641290 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:53:15.641290 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: BEGIN
[0m17:53:15.641290 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:15.674527 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m17:53:15.690152 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:53:15.691331 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_email.f6780dacc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "sales_db"."public"."example"
where email is null



      
    ) dbt_internal_test
[0m17:53:15.724288 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.038 seconds
[0m17:53:15.724288 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: ROLLBACK
[0m17:53:15.724288 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: Close
[0m17:53:15.724288 [info ] [Thread-1 (]: 1 of 3 PASS not_null_example_email ............................................. [[32mPASS[0m in 0.13s]
[0m17:53:15.724288 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:15.739914 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:15.740838 [info ] [Thread-1 (]: 2 of 3 START test not_null_example_id .......................................... [RUN]
[0m17:53:15.741395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m17:53:15.741395 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:15.741395 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:53:15.741395 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:15.741395 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:53:15.741395 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:53:15.741395 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: BEGIN
[0m17:53:15.757022 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:15.807977 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m17:53:15.807977 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:53:15.807977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_id.96691fbe5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sales_db"."public"."example"
where id is null



      
    ) dbt_internal_test
[0m17:53:15.807977 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m17:53:15.807977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: ROLLBACK
[0m17:53:15.807977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: Close
[0m17:53:15.807977 [info ] [Thread-1 (]: 2 of 3 PASS not_null_example_id ................................................ [[32mPASS[0m in 0.07s]
[0m17:53:15.807977 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:15.807977 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:15.807977 [info ] [Thread-1 (]: 3 of 3 START test unique_example_id ............................................ [RUN]
[0m17:53:15.807977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m17:53:15.807977 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:15.824735 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:53:15.824735 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:15.824735 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:53:15.874366 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:53:15.874366 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: BEGIN
[0m17:53:15.874366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:53:15.957872 [debug] [Thread-1 (]: SQL status: BEGIN in 0.084 seconds
[0m17:53:15.957872 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:53:15.957872 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_example_id.50f543cf6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sales_db"."public"."example"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:53:15.957872 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m17:53:15.957872 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: ROLLBACK
[0m17:53:15.974508 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: Close
[0m17:53:15.974591 [info ] [Thread-1 (]: 3 of 3 PASS unique_example_id .................................................. [[32mPASS[0m in 0.17s]
[0m17:53:15.974591 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:15.974591 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:15.974591 [debug] [MainThread]: On master: BEGIN
[0m17:53:15.974591 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:16.024615 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m17:53:16.024615 [debug] [MainThread]: On master: COMMIT
[0m17:53:16.024615 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:16.024615 [debug] [MainThread]: On master: COMMIT
[0m17:53:16.024615 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:16.024615 [debug] [MainThread]: On master: Close
[0m17:53:16.024615 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:16.024615 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:53:16.024615 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_example_id.50f543cf6e' was properly closed.
[0m17:53:16.024615 [info ] [MainThread]: 
[0m17:53:16.024615 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 0.88 seconds (0.88s).
[0m17:53:16.041497 [debug] [MainThread]: Command end result
[0m17:53:16.058122 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:16.058122 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:16.074855 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:53:16.074855 [info ] [MainThread]: 
[0m17:53:16.074855 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:16.074855 [info ] [MainThread]: 
[0m17:53:16.074855 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m17:53:16.074855 [debug] [MainThread]: Command `dbt test` succeeded at 17:53:16.074855 after 3.01 seconds
[0m17:53:16.074855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B95254E30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B952576B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022B9545FB00>]}
[0m17:53:16.074855 [debug] [MainThread]: Flushing usage events
[0m17:53:16.540805 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:26.854894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8CA2AD20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F0DF380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F0DCC20>]}


============================== 17:53:26.854894 | 0b80ed5d-c759-4f82-b803-b9ff9d4c753b ==============================
[0m17:53:26.854894 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:53:26.871002 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:27.387948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8EC93830>]}
[0m17:53:27.521110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8CCAE2D0>]}
[0m17:53:27.521110 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:27.904632 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:53:28.204438 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:28.204438 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:28.204438 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m17:53:28.304480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE90BE8140>]}
[0m17:53:28.354478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE90DCBB60>]}
[0m17:53:28.354478 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 431 macros
[0m17:53:28.354478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE90D93A40>]}
[0m17:53:28.354478 [info ] [MainThread]: 
[0m17:53:28.354478 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:28.354478 [info ] [MainThread]: 
[0m17:53:28.370624 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:28.371338 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:53:28.504315 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:28.504315 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:53:28.504315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:28.587804 [debug] [ThreadPool]: SQL status: BEGIN in 0.073 seconds
[0m17:53:28.587804 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:28.587804 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:53:28.603430 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.009 seconds
[0m17:53:28.604331 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:53:28.604331 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:53:28.604331 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:28.619956 [debug] [MainThread]: On master: BEGIN
[0m17:53:28.620958 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:28.670918 [debug] [MainThread]: SQL status: BEGIN in 0.062 seconds
[0m17:53:28.670918 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:28.670918 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:28.687641 [debug] [MainThread]: SQL status: SELECT 1 in 0.016 seconds
[0m17:53:28.704413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b80ed5d-c759-4f82-b803-b9ff9d4c753b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F95D190>]}
[0m17:53:28.704413 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:28.704413 [debug] [MainThread]: On master: Close
[0m17:53:28.704413 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:53:28.704413 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:53:28.704413 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:53:28.721110 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:53:28.721110 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:53:28.721110 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:53:28.721110 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:28.737619 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now test.my_dbt_project.not_null_example_email.f6780dacc6)
[0m17:53:28.737619 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:28.754436 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m17:53:28.754436 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:28.754436 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m17:53:28.754436 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:28.754436 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m17:53:28.770062 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:28.771140 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m17:53:28.771140 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:28.771140 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m17:53:28.771140 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:28.787795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m17:53:28.787795 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:28.803851 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m17:53:28.804352 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:28.804352 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m17:53:28.804352 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:28.804352 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:53:28.804352 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_example_id.50f543cf6e' was properly closed.
[0m17:53:28.804352 [debug] [MainThread]: Command end result
[0m17:53:28.970951 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:28.970951 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:28.987609 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:53:29.004327 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m17:53:29.004327 [info ] [MainThread]: Building catalog
[0m17:53:29.004327 [debug] [ThreadPool]: Acquiring new postgres connection 'sales_db.information_schema'
[0m17:53:29.020988 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m17:53:29.020988 [debug] [ThreadPool]: On sales_db.information_schema: BEGIN
[0m17:53:29.020988 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:29.070981 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m17:53:29.070981 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m17:53:29.086969 [debug] [ThreadPool]: On sales_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "sales_db.information_schema"} */

    
    

    select
        'sales_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('example')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('users')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m17:53:29.104556 [debug] [ThreadPool]: SQL status: SELECT 9 in 0.018 seconds
[0m17:53:29.104556 [debug] [ThreadPool]: On sales_db.information_schema: ROLLBACK
[0m17:53:29.104556 [debug] [ThreadPool]: On sales_db.information_schema: Close
[0m17:53:29.121010 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m17:53:29.154115 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:29.170797 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:29.170797 [info ] [MainThread]: Catalog written to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m17:53:29.170797 [debug] [MainThread]: Command `dbt docs generate` succeeded at 17:53:29.170797 after 2.51 seconds
[0m17:53:29.170797 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m17:53:29.170797 [debug] [MainThread]: Connection 'sales_db.information_schema' was properly closed.
[0m17:53:29.170797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F6994C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F785100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FE8F7850D0>]}
[0m17:53:29.170797 [debug] [MainThread]: Flushing usage events
[0m17:53:29.587025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:35.602441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D455CE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D455C230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D43C9E20>]}


============================== 17:53:35.602441 | 08fc369a-3ae6-430e-8eca-ff0cb28c3471 ==============================
[0m17:53:35.602441 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:53:35.602441 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:53:36.002149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D4B1B560>]}
[0m17:53:36.118982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D386C5F0>]}
[0m17:53:36.118982 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:53:36.485422 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:53:36.751873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:53:36.751873 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:53:36.751873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m17:53:36.818742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5C1C680>]}
[0m17:53:36.935353 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:36.935353 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:36.968694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5F2F1D0>]}
[0m17:53:36.968694 [info ] [MainThread]: Found 1 model, 3 data tests, 1 source, 431 macros
[0m17:53:36.968694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5EF22A0>]}
[0m17:53:36.985647 [info ] [MainThread]: 
[0m17:53:36.985647 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:53:36.985647 [info ] [MainThread]: 
[0m17:53:36.985647 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:53:36.985647 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m17:53:37.135363 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m17:53:37.135363 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m17:53:37.135363 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:37.201977 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.067 seconds
[0m17:53:37.201977 [debug] [ThreadPool]: On list_sales_db: Close
[0m17:53:37.201977 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m17:53:37.221198 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:37.221198 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m17:53:37.221198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:53:37.268529 [debug] [ThreadPool]: SQL status: BEGIN in 0.055 seconds
[0m17:53:37.268529 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m17:53:37.284154 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m17:53:37.285275 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.007 seconds
[0m17:53:37.285275 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m17:53:37.285275 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m17:53:37.301853 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.301853 [debug] [MainThread]: On master: BEGIN
[0m17:53:37.301853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:53:37.351854 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m17:53:37.351854 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.351854 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:53:37.351854 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m17:53:37.368545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D5F38350>]}
[0m17:53:37.368545 [debug] [MainThread]: On master: ROLLBACK
[0m17:53:37.368545 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.368545 [debug] [MainThread]: On master: BEGIN
[0m17:53:37.368545 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:53:37.368545 [debug] [MainThread]: On master: COMMIT
[0m17:53:37.368545 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.368545 [debug] [MainThread]: On master: COMMIT
[0m17:53:37.368545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:37.368545 [debug] [MainThread]: On master: Close
[0m17:53:37.368545 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m17:53:37.368545 [info ] [Thread-1 (]: 1 of 1 START sql view model public.example ..................................... [RUN]
[0m17:53:37.368545 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m17:53:37.368545 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m17:53:37.385162 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m17:53:37.385162 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m17:53:37.435231 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m17:53:37.452016 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.452016 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m17:53:37.452016 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:53:37.501834 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m17:53:37.501834 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.501834 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m17:53:37.518605 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m17:53:37.518605 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.534597 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m17:53:37.535242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:53:37.535242 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.535242 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m17:53:37.535242 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:53:37.568429 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:53:37.568429 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.568429 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m17:53:37.568429 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m17:53:37.568429 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m17:53:37.585126 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m17:53:37.585126 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop view if exists "sales_db"."public"."example__dbt_backup" cascade
[0m17:53:37.585126 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:53:37.585126 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m17:53:37.585126 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '08fc369a-3ae6-430e-8eca-ff0cb28c3471', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D1C67680>]}
[0m17:53:37.585126 [info ] [Thread-1 (]: 1 of 1 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.22s]
[0m17:53:37.601976 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m17:53:37.601976 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.601976 [debug] [MainThread]: On master: BEGIN
[0m17:53:37.601976 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:37.650921 [debug] [MainThread]: SQL status: BEGIN in 0.046 seconds
[0m17:53:37.651894 [debug] [MainThread]: On master: COMMIT
[0m17:53:37.651894 [debug] [MainThread]: Using postgres connection "master"
[0m17:53:37.651894 [debug] [MainThread]: On master: COMMIT
[0m17:53:37.651894 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:53:37.651894 [debug] [MainThread]: On master: Close
[0m17:53:37.651894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:37.651894 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m17:53:37.651894 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m17:53:37.651894 [debug] [MainThread]: Connection 'model.my_dbt_project.example' was properly closed.
[0m17:53:37.651894 [info ] [MainThread]: 
[0m17:53:37.651894 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.67 seconds (0.67s).
[0m17:53:37.651894 [debug] [MainThread]: Command end result
[0m17:53:37.685606 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m17:53:37.685606 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m17:53:37.685606 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m17:53:37.685606 [info ] [MainThread]: 
[0m17:53:37.701232 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:53:37.702406 [info ] [MainThread]: 
[0m17:53:37.702406 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m17:53:37.702406 [debug] [MainThread]: Command `dbt run` succeeded at 17:53:37.702406 after 2.29 seconds
[0m17:53:37.702406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D487BD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D48CFE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217D6365070>]}
[0m17:53:37.702406 [debug] [MainThread]: Flushing usage events
[0m17:53:38.151336 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:44.183354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB2CEE690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB5B45910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB5B45220>]}


============================== 17:53:44.183354 | 7dfd96fd-665d-4397-ad93-4a4d400e25d8 ==============================
[0m17:53:44.183354 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:53:44.200187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt docs serve', 'send_anonymous_usage_stats': 'True'}
[0m17:53:44.549861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dfd96fd-665d-4397-ad93-4a4d400e25d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB5B45850>]}
[0m17:53:44.683133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dfd96fd-665d-4397-ad93-4a4d400e25d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB56A7EC0>]}
[0m18:19:04.633972 [error] [MainThread]: Encountered an error:

[0m18:19:04.642950 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:19:04.645948 [debug] [MainThread]: Command `dbt docs serve` failed at 18:19:04.644948 after 1520.66 seconds
[0m18:19:04.646947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB6E990A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB5A2F2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB6DFAEA0>]}
[0m18:19:04.647948 [debug] [MainThread]: Flushing usage events
[0m18:19:05.082700 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:19:11.863827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4EFA2780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4E3AFA10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4EE49550>]}


============================== 18:19:11.868822 | 81a578b3-d76b-42a1-996b-a6ac1895cdfc ==============================
[0m18:19:11.868822 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:19:11.869822 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:19:12.192638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '81a578b3-d76b-42a1-996b-a6ac1895cdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4ED24DA0>]}
[0m18:19:12.298577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '81a578b3-d76b-42a1-996b-a6ac1895cdfc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4F209100>]}
[0m18:19:12.299576 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:19:12.629388 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:19:12.876247 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m18:19:12.877246 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\sales_by_month.sql
[0m18:19:12.877246 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\order_status_summary.sql
[0m18:19:12.878247 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_order_summary.sql
[0m18:19:12.879246 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_segmentation.sql
[0m18:19:12.879246 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yaml
[0m18:19:13.669794 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.sales_by_month' (models\marts\sales_by_month.sql) depends on a node named 'orders' which was not found
[0m18:19:13.671793 [debug] [MainThread]: Command `dbt run` failed at 18:19:13.671793 after 2.03 seconds
[0m18:19:13.672793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA4EE6FBC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA5078C4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EA50A80860>]}
[0m18:19:13.673791 [debug] [MainThread]: Flushing usage events
[0m18:19:14.104546 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:21:34.226136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FC8317470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCB465820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCB3F8A40>]}


============================== 18:21:34.232132 | 278b6a7b-5a12-4b30-ad28-df3be275757f ==============================
[0m18:21:34.232132 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:21:34.233130 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:21:34.537956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '278b6a7b-5a12-4b30-ad28-df3be275757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCBF59BB0>]}
[0m18:21:34.633901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '278b6a7b-5a12-4b30-ad28-df3be275757f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCBD35C70>]}
[0m18:21:34.635902 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:21:34.955718 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:21:35.148608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m18:21:35.149607 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\order_status_summary.sql
[0m18:21:35.150606 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_segmentation.sql
[0m18:21:35.150606 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\sales_by_month.sql
[0m18:21:35.151606 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_order_summary.sql
[0m18:21:35.152605 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yaml
[0m18:21:35.935160 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.order_status_summary' (models\marts\order_status_summary.sql) depends on a node named 'orders' which was not found
[0m18:21:35.938165 [debug] [MainThread]: Command `dbt run` failed at 18:21:35.937157 after 1.91 seconds
[0m18:21:35.939156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCAE65B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCD2EFF50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013FCD52FBF0>]}
[0m18:21:35.939156 [debug] [MainThread]: Flushing usage events
[0m18:21:36.375925 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:26:23.219361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C18F5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6CBC4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6CBC6030>]}


============================== 18:26:23.224358 | 5e10a62a-cb08-4dc7-9351-c377a79e6419 ==============================
[0m18:26:23.224358 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:26:23.225358 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:26:23.535182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e10a62a-cb08-4dc7-9351-c377a79e6419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C6EDEE0>]}
[0m18:26:23.634126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e10a62a-cb08-4dc7-9351-c377a79e6419', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C9F4DA0>]}
[0m18:26:23.636123 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:26:23.955941 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:26:24.185809 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 4 files added, 1 files changed.
[0m18:26:24.186808 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\sales_by_month.sql
[0m18:26:24.187809 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_order_summary.sql
[0m18:26:24.187809 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\order_status_summary.sql
[0m18:26:24.188807 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\user_segmentation.sql
[0m18:26:24.189807 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yaml
[0m18:26:24.977358 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.my_dbt_project.sales_by_month' (models\marts\sales_by_month.sql) depends on a node named 'orders' which was not found
[0m18:26:24.979356 [debug] [MainThread]: Command `dbt run` failed at 18:26:24.979356 after 1.96 seconds
[0m18:26:24.980355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6C294500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6E4E5C40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ED6E34BE30>]}
[0m18:26:24.981356 [debug] [MainThread]: Flushing usage events
[0m18:26:25.397119 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:24.935305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DD7C4B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DB6511F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DB53B710>]}


============================== 18:28:24.940303 | 88f6cff3-fe08-42d6-98d4-1379ed8b0150 ==============================
[0m18:28:24.940303 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:28:24.942302 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:28:25.269114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DE3AC650>]}
[0m18:28:25.375054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DD8339B0>]}
[0m18:28:25.376053 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:28:25.680881 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:28:25.982707 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m18:28:25.983707 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\sales_by_month.sql
[0m18:28:25.983707 [debug] [MainThread]: Partial parsing: added file: my_dbt_project://models\marts\order_status_summary.sql
[0m18:28:25.984707 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\schema.yaml
[0m18:28:26.427453 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'user_order_summary' in the 'models' section of file 'models\schema.yaml'
[0m18:28:26.434449 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'user_segmentation' in the 'models' section of file 'models\schema.yaml'
[0m18:28:26.759264 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04' (models\schema.yaml) depends on a node named 'user_order_summary' in package '' which was not found
[0m18:28:26.760264 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_order_summary_user_id.744111b232' (models\schema.yaml) depends on a node named 'user_order_summary' in package '' which was not found
[0m18:28:26.761263 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c' (models\schema.yaml) depends on a node named 'user_order_summary' in package '' which was not found
[0m18:28:26.762263 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6' (models\schema.yaml) depends on a node named 'user_order_summary' in package '' which was not found
[0m18:28:26.763262 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd' (models\schema.yaml) depends on a node named 'user_segmentation' in package '' which was not found
[0m18:28:26.764261 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3' (models\schema.yaml) depends on a node named 'user_segmentation' in package '' which was not found
[0m18:28:26.765260 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8' (models\schema.yaml) depends on a node named 'user_segmentation' in package '' which was not found
[0m18:28:26.766261 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7' (models\schema.yaml) depends on a node named 'user_segmentation' in package '' which was not found
[0m18:28:26.854210 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:28:26.869202 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DF9E1CA0>]}
[0m18:28:26.998127 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:28:27.003124 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:28:27.043101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DFC64290>]}
[0m18:28:27.044100 [info ] [MainThread]: Found 3 models, 9 data tests, 2 sources, 431 macros
[0m18:28:27.045101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DDE42EA0>]}
[0m18:28:27.048099 [info ] [MainThread]: 
[0m18:28:27.049098 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:28:27.050099 [info ] [MainThread]: 
[0m18:28:27.051097 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:28:27.056095 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m18:28:27.156038 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m18:28:27.157037 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m18:28:27.157037 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:27.212005 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.055 seconds
[0m18:28:27.214003 [debug] [ThreadPool]: On list_sales_db: Close
[0m18:28:27.217002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:28:27.227996 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:28:27.228995 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:28:27.229995 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:28:27.279968 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m18:28:27.280966 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:28:27.280966 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:28:27.287963 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.006 seconds
[0m18:28:27.289960 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:28:27.289960 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:28:27.296956 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.297956 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.297956 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:28:27.348927 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m18:28:27.348927 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.349926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:28:27.357923 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m18:28:27.359921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E0208D10>]}
[0m18:28:27.360920 [debug] [MainThread]: On master: ROLLBACK
[0m18:28:27.361919 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.361919 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.362918 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:28:27.362918 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.363919 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.363919 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.364917 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:27.365918 [debug] [MainThread]: On master: Close
[0m18:28:27.368915 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m18:28:27.369915 [info ] [Thread-1 (]: 1 of 3 START sql view model public.example ..................................... [RUN]
[0m18:28:27.371914 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m18:28:27.372916 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m18:28:27.380908 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m18:28:27.382908 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m18:28:27.422885 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m18:28:27.423884 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.424884 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m18:28:27.424884 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:28:27.471857 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:28:27.472855 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.473855 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m18:28:27.479852 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:28:27.488846 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.489845 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m18:28:27.490845 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:28:27.494843 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.495843 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m18:28:27.496843 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:27.517830 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:28:27.518829 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.518829 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:28:27.522827 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:28:27.529823 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m18:28:27.539817 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:28:27.540817 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop view if exists "sales_db"."public"."example__dbt_backup" cascade
[0m18:28:27.541818 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:28:27.545815 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m18:28:27.550811 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DB757560>]}
[0m18:28:27.551811 [info ] [Thread-1 (]: 1 of 3 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.18s]
[0m18:28:27.553811 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m18:28:27.554809 [debug] [Thread-1 (]: Began running node model.my_dbt_project.order_status_summary
[0m18:28:27.555809 [info ] [Thread-1 (]: 2 of 3 START sql view model public.order_status_summary ........................ [RUN]
[0m18:28:27.556808 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.order_status_summary)
[0m18:28:27.557808 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.order_status_summary
[0m18:28:27.565803 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.order_status_summary"
[0m18:28:27.567802 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.order_status_summary
[0m18:28:27.647756 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.order_status_summary"
[0m18:28:27.649755 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:28:27.650756 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: BEGIN
[0m18:28:27.650756 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.697730 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:28:27.698727 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:28:27.699728 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */

  create view "sales_db"."public"."order_status_summary__dbt_tmp"
    
    
  as (
    -- models/marts/order_status_summary.sql

select
    status,
    count(*) as total_orders,
    sum(order_amount) as total_amount
from
    "sales_db"."public"."orders"
group by
    status
order by
    total_orders desc
  );
[0m18:28:27.706722 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:28:27.709721 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:28:27.710720 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary__dbt_tmp" rename to "order_status_summary"
[0m18:28:27.711720 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:28:27.713718 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:28:27.713718 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:28:27.714717 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:28:27.716718 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:27.719715 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."order_status_summary__dbt_backup"
[0m18:28:27.720715 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:28:27.720715 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
drop view if exists "sales_db"."public"."order_status_summary__dbt_backup" cascade
[0m18:28:27.721715 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:28:27.724712 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: Close
[0m18:28:27.725711 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DE4E81A0>]}
[0m18:28:27.727710 [info ] [Thread-1 (]: 2 of 3 OK created sql view model public.order_status_summary ................... [[32mCREATE VIEW[0m in 0.17s]
[0m18:28:27.728710 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.order_status_summary
[0m18:28:27.729710 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_by_month
[0m18:28:27.730709 [info ] [Thread-1 (]: 3 of 3 START sql view model public.sales_by_month .............................. [RUN]
[0m18:28:27.732709 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.order_status_summary, now model.my_dbt_project.sales_by_month)
[0m18:28:27.733707 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_by_month
[0m18:28:27.736705 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_by_month"
[0m18:28:27.737704 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_by_month
[0m18:28:27.742702 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_by_month"
[0m18:28:27.743701 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:28:27.744701 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: BEGIN
[0m18:28:27.745701 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:28:27.794673 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:28:27.795672 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:28:27.795672 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */

  create view "sales_db"."public"."sales_by_month__dbt_tmp"
    
    
  as (
    -- models/marts/sales_by_month.sql

with monthly_sales as (
    select
        date_trunc('month', order_date) as month,
        sum(order_amount) as total_sales,
        count(*) as total_orders
    from
        "sales_db"."public"."orders"
    where
        status = 'Completed'
    group by
        month
)

select
    month,
    total_sales,
    total_orders
from
    monthly_sales
order by
    month
  );
[0m18:28:27.804667 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m18:28:27.807665 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:28:27.808665 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month__dbt_tmp" rename to "sales_by_month"
[0m18:28:27.809664 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:28:27.810663 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:28:27.811662 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:28:27.812662 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:28:27.814662 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:28:27.819661 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."sales_by_month__dbt_backup"
[0m18:28:27.821657 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:28:27.821657 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
drop view if exists "sales_db"."public"."sales_by_month__dbt_backup" cascade
[0m18:28:27.822657 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:28:27.825655 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: Close
[0m18:28:27.826654 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '88f6cff3-fe08-42d6-98d4-1379ed8b0150', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DF997290>]}
[0m18:28:27.828654 [info ] [Thread-1 (]: 3 of 3 OK created sql view model public.sales_by_month ......................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:28:27.830653 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_by_month
[0m18:28:27.833651 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.834651 [debug] [MainThread]: On master: BEGIN
[0m18:28:27.836650 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:28:27.912606 [debug] [MainThread]: SQL status: BEGIN in 0.076 seconds
[0m18:28:27.913605 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.913605 [debug] [MainThread]: Using postgres connection "master"
[0m18:28:27.914606 [debug] [MainThread]: On master: COMMIT
[0m18:28:27.915604 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:28:27.916603 [debug] [MainThread]: On master: Close
[0m18:28:27.917602 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:28:27.918602 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m18:28:27.919601 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:28:27.920600 [debug] [MainThread]: Connection 'model.my_dbt_project.sales_by_month' was properly closed.
[0m18:28:27.921600 [info ] [MainThread]: 
[0m18:28:27.922600 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m18:28:27.925598 [debug] [MainThread]: Command end result
[0m18:28:27.966574 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:28:27.971572 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:28:27.983565 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:28:27.983565 [info ] [MainThread]: 
[0m18:28:27.985564 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:28:27.986564 [info ] [MainThread]: 
[0m18:28:27.987563 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:28:27.989561 [debug] [MainThread]: Command `dbt run` succeeded at 18:28:27.989561 after 3.26 seconds
[0m18:28:27.990561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DD982F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DD7F2180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215DD7F1C10>]}
[0m18:28:27.991560 [debug] [MainThread]: Flushing usage events
[0m18:28:28.426311 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:31:57.651687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F083F78D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F083FE3B00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08410CFE0>]}


============================== 18:31:57.658683 | c5f94382-3b62-4eaf-9de8-ee04917f56fb ==============================
[0m18:31:57.658683 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:31:57.660683 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:31:58.004486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0838F0740>]}
[0m18:31:58.105427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08442A1E0>]}
[0m18:31:58.108427 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:31:58.437238 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:31:58.586153 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m18:31:58.588153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F085986D20>]}
[0m18:32:00.583013 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:32:00.599004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F085B18CB0>]}
[0m18:32:00.707941 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:32:00.712938 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:32:00.749918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0858D5E50>]}
[0m18:32:00.749918 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:32:00.750918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08593FAD0>]}
[0m18:32:00.753916 [info ] [MainThread]: 
[0m18:32:00.754915 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:32:00.756915 [info ] [MainThread]: 
[0m18:32:00.757913 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:32:00.764909 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m18:32:00.867850 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m18:32:00.867850 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m18:32:00.868850 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:00.922820 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.054 seconds
[0m18:32:00.924818 [debug] [ThreadPool]: On list_sales_db: Close
[0m18:32:00.927817 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:32:00.937810 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:32:00.938809 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:32:00.938809 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:32:00.996778 [debug] [ThreadPool]: SQL status: BEGIN in 0.058 seconds
[0m18:32:00.997777 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:32:00.998775 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:32:01.004773 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m18:32:01.006771 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:32:01.007770 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:32:01.014767 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.015767 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.015767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:32:01.066737 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m18:32:01.067736 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.068736 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:32:01.078730 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m18:32:01.082728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F085B953A0>]}
[0m18:32:01.083727 [debug] [MainThread]: On master: ROLLBACK
[0m18:32:01.083727 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.084726 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.085726 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:32:01.085726 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.086725 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.086725 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.087724 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:32:01.087724 [debug] [MainThread]: On master: Close
[0m18:32:01.090723 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m18:32:01.091723 [info ] [Thread-1 (]: 1 of 5 START sql view model public.example ..................................... [RUN]
[0m18:32:01.093721 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m18:32:01.094721 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m18:32:01.101717 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m18:32:01.103716 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m18:32:01.157684 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m18:32:01.159684 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.159684 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m18:32:01.160683 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:32:01.322592 [debug] [Thread-1 (]: SQL status: BEGIN in 0.161 seconds
[0m18:32:01.323590 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.324589 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m18:32:01.331585 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:32:01.339581 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.339581 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m18:32:01.341580 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:32:01.344578 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.345577 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m18:32:01.346579 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:32:01.365566 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:32:01.366565 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.367565 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:32:01.370563 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:32:01.378559 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m18:32:01.383556 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:32:01.384555 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop view if exists "sales_db"."public"."example__dbt_backup" cascade
[0m18:32:01.386555 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:32:01.390552 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m18:32:01.395550 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0818174A0>]}
[0m18:32:01.396549 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.30s]
[0m18:32:01.398547 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m18:32:01.399547 [debug] [Thread-1 (]: Began running node model.my_dbt_project.order_status_summary
[0m18:32:01.399547 [info ] [Thread-1 (]: 2 of 5 START sql view model public.order_status_summary ........................ [RUN]
[0m18:32:01.400546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.order_status_summary)
[0m18:32:01.401546 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.order_status_summary
[0m18:32:01.407543 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.order_status_summary"
[0m18:32:01.408542 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.order_status_summary
[0m18:32:01.412538 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.order_status_summary"
[0m18:32:01.413538 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.414538 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: BEGIN
[0m18:32:01.415537 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:01.470507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m18:32:01.471505 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.472505 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */

  create view "sales_db"."public"."order_status_summary__dbt_tmp"
    
    
  as (
    -- models/marts/order_status_summary.sql

select
    status,
    count(*) as total_orders,
    sum(order_amount) as total_amount
from
    "sales_db"."public"."orders"
group by
    status
order by
    total_orders desc
  );
[0m18:32:01.477502 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:32:01.481500 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.482499 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary" rename to "order_status_summary__dbt_backup"
[0m18:32:01.483499 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:32:01.486497 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.487496 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary__dbt_tmp" rename to "order_status_summary"
[0m18:32:01.488496 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:32:01.490495 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:32:01.491494 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.492494 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:32:01.493494 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:32:01.496491 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."order_status_summary__dbt_backup"
[0m18:32:01.497491 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:32:01.497491 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
drop view if exists "sales_db"."public"."order_status_summary__dbt_backup" cascade
[0m18:32:01.499491 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:32:01.504486 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: Close
[0m18:32:01.505487 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F086314950>]}
[0m18:32:01.507486 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.order_status_summary ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:32:01.508485 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.order_status_summary
[0m18:32:01.509485 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_by_month
[0m18:32:01.510485 [info ] [Thread-1 (]: 3 of 5 START sql view model public.sales_by_month .............................. [RUN]
[0m18:32:01.511483 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.order_status_summary, now model.my_dbt_project.sales_by_month)
[0m18:32:01.511483 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_by_month
[0m18:32:01.515481 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_by_month"
[0m18:32:01.516480 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_by_month
[0m18:32:01.523477 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_by_month"
[0m18:32:01.525475 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.526475 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: BEGIN
[0m18:32:01.526475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:01.579444 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:32:01.580444 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.581442 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */

  create view "sales_db"."public"."sales_by_month__dbt_tmp"
    
    
  as (
    -- models/marts/sales_by_month.sql

with monthly_sales as (
    select
        date_trunc('month', order_date) as month,
        sum(order_amount) as total_sales,
        count(*) as total_orders
    from
        "sales_db"."public"."orders"
    where
        status = 'Completed'
    group by
        month
)

select
    month,
    total_sales,
    total_orders
from
    monthly_sales
order by
    month
  );
[0m18:32:01.588439 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:32:01.594435 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.595434 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month" rename to "sales_by_month__dbt_backup"
[0m18:32:01.596435 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:32:01.599432 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.600431 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month__dbt_tmp" rename to "sales_by_month"
[0m18:32:01.601433 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:32:01.603430 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:32:01.603430 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.604430 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:32:01.607427 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:32:01.612425 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."sales_by_month__dbt_backup"
[0m18:32:01.614423 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:32:01.615424 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
drop view if exists "sales_db"."public"."sales_by_month__dbt_backup" cascade
[0m18:32:01.617422 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:32:01.618422 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: Close
[0m18:32:01.619421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0856E7E30>]}
[0m18:32:01.621421 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.sales_by_month ......................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:32:01.623421 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_by_month
[0m18:32:01.625418 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_order_summary
[0m18:32:01.626417 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_order_summary .......................... [RUN]
[0m18:32:01.627417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_by_month, now model.my_dbt_project.user_order_summary)
[0m18:32:01.627417 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_order_summary
[0m18:32:01.633413 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_order_summary"
[0m18:32:01.635412 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_order_summary
[0m18:32:01.642409 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_order_summary"
[0m18:32:01.644407 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:32:01.645407 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: BEGIN
[0m18:32:01.645407 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:01.691381 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:32:01.692380 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:32:01.693378 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */

  create view "sales_db"."public"."user_order_summary__dbt_tmp"
    
    
  as (
    -- models/marts/user_order_summary.sql

with user_orders as (
    select
        u.id as user_id,
        u.name,
        u.email,
        o.order_amount,
        o.status,
        o.order_date
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
),

aggregated_data as (
    select
        user_id,
        name,
        email,
        count(*) as total_orders,
        sum(order_amount) as total_amount,
        max(order_date) as last_order_date
    from
        user_orders
    group by
        user_id, name, email
)

select * from aggregated_data;
  );
[0m18:32:01.695378 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 39: select * from aggregated_data;
                                      ^

[0m18:32:01.696377 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: ROLLBACK
[0m18:32:01.697377 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: Close
[0m18:32:01.712368 [debug] [Thread-1 (]: Database Error in model user_order_summary (models\marts\user_order_summary.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 39: select * from aggregated_data;
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\user_order_summary.sql
[0m18:32:01.713368 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F085D1AA80>]}
[0m18:32:01.714367 [error] [Thread-1 (]: 4 of 5 ERROR creating sql view model public.user_order_summary ................. [[31mERROR[0m in 0.09s]
[0m18:32:01.715367 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_order_summary
[0m18:32:01.716366 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_segmentation
[0m18:32:01.717365 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.user_order_summary' to be skipped because of status 'error'.  Reason: Database Error in model user_order_summary (models\marts\user_order_summary.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 39: select * from aggregated_data;
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\user_order_summary.sql.
[0m18:32:01.718364 [info ] [Thread-1 (]: 5 of 5 START sql view model public.user_segmentation ........................... [RUN]
[0m18:32:01.720364 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.user_order_summary, now model.my_dbt_project.user_segmentation)
[0m18:32:01.720364 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_segmentation
[0m18:32:01.725361 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_segmentation"
[0m18:32:01.726360 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_segmentation
[0m18:32:01.730358 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_segmentation"
[0m18:32:01.732357 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:32:01.733356 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: BEGIN
[0m18:32:01.733356 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:32:01.786326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:32:01.787326 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:32:01.788325 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */

  create view "sales_db"."public"."user_segmentation__dbt_tmp"
    
    
  as (
    -- models/marts/user_segmentation.sql

with user_rfm as (
    select
        u.id as user_id,
        u.name,
        u.email,
        max(o.order_date) as last_order_date,
        count(*) as total_orders,
        sum(o.order_amount) as total_spent
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
    group by
        u.id, u.name, u.email
),

user_segments as (
    select
        user_id,
        name,
        email,
        last_order_date,
        total_orders,
        total_spent,
        case
            when total_spent > 1000 then 'High Value'
            when total_spent between 500 and 1000 then 'Medium Value'
            else 'Low Value'
        end as value_segment
    from
        user_rfm
)

select * from user_segments;
  );
[0m18:32:01.789324 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  erreur de syntaxe sur ou près de « ; »
LINE 44: select * from user_segments;
                                    ^

[0m18:32:01.790324 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: ROLLBACK
[0m18:32:01.791323 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: Close
[0m18:32:01.795321 [debug] [Thread-1 (]: Database Error in model user_segmentation (models\marts\user_segmentation.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 44: select * from user_segments;
                                      ^
  compiled code at target\run\my_dbt_project\models\marts\user_segmentation.sql
[0m18:32:01.796320 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5f94382-3b62-4eaf-9de8-ee04917f56fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0861FD6A0>]}
[0m18:32:01.797320 [error] [Thread-1 (]: 5 of 5 ERROR creating sql view model public.user_segmentation .................. [[31mERROR[0m in 0.08s]
[0m18:32:01.799319 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_segmentation
[0m18:32:01.800319 [debug] [Thread-4 (]: Marking all children of 'model.my_dbt_project.user_segmentation' to be skipped because of status 'error'.  Reason: Database Error in model user_segmentation (models\marts\user_segmentation.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 44: select * from user_segments;
                                      ^
  compiled code at target\run\my_dbt_project\models\marts\user_segmentation.sql.
[0m18:32:01.802317 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.802317 [debug] [MainThread]: On master: BEGIN
[0m18:32:01.803316 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:32:01.850290 [debug] [MainThread]: SQL status: BEGIN in 0.047 seconds
[0m18:32:01.851288 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.852288 [debug] [MainThread]: Using postgres connection "master"
[0m18:32:01.852288 [debug] [MainThread]: On master: COMMIT
[0m18:32:01.853288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:32:01.854287 [debug] [MainThread]: On master: Close
[0m18:32:01.855286 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:32:01.856288 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m18:32:01.857286 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:32:01.857286 [debug] [MainThread]: Connection 'model.my_dbt_project.user_segmentation' was properly closed.
[0m18:32:01.858284 [info ] [MainThread]: 
[0m18:32:01.859286 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m18:32:01.861283 [debug] [MainThread]: Command end result
[0m18:32:01.898262 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:32:01.902260 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:32:01.912254 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:32:01.913255 [info ] [MainThread]: 
[0m18:32:01.915255 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:32:01.916253 [info ] [MainThread]: 
[0m18:32:01.918252 [error] [MainThread]:   Database Error in model user_order_summary (models\marts\user_order_summary.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 39: select * from aggregated_data;
                                        ^
  compiled code at target\run\my_dbt_project\models\marts\user_order_summary.sql
[0m18:32:01.919251 [info ] [MainThread]: 
[0m18:32:01.920250 [error] [MainThread]:   Database Error in model user_segmentation (models\marts\user_segmentation.sql)
  ERREUR:  erreur de syntaxe sur ou près de « ; »
  LINE 44: select * from user_segments;
                                      ^
  compiled code at target\run\my_dbt_project\models\marts\user_segmentation.sql
[0m18:32:01.921250 [info ] [MainThread]: 
[0m18:32:01.923249 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:32:01.925247 [debug] [MainThread]: Command `dbt run` failed at 18:32:01.925247 after 4.49 seconds
[0m18:32:01.927246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F08416AFC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F084053FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F0840504A0>]}
[0m18:32:01.928245 [debug] [MainThread]: Flushing usage events
[0m18:32:02.458941 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:32:58.149191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126ED0CB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126ED0C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126ED0B60>]}


============================== 18:32:58.154188 | 86477af3-c867-4d71-a22a-901ef042071d ==============================
[0m18:32:58.154188 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:32:58.157188 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:32:58.484000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12682FEC0>]}
[0m18:32:58.586942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126465730>]}
[0m18:32:58.588940 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:32:58.936741 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:32:59.194594 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:32:59.195593 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\user_order_summary.sql
[0m18:32:59.196595 [debug] [MainThread]: Partial parsing: updated file: my_dbt_project://models\marts\user_segmentation.sql
[0m18:33:00.066097 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:33:00.085085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1285326F0>]}
[0m18:33:00.190026 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:33:00.198021 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:33:00.235000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1288127E0>]}
[0m18:33:00.236000 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:33:00.236999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12884EA80>]}
[0m18:33:00.240996 [info ] [MainThread]: 
[0m18:33:00.241996 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:00.242996 [info ] [MainThread]: 
[0m18:33:00.243995 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:00.250991 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m18:33:00.372923 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m18:33:00.373921 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m18:33:00.374920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:00.425891 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.051 seconds
[0m18:33:00.427892 [debug] [ThreadPool]: On list_sales_db: Close
[0m18:33:00.429890 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:33:00.436886 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:33:00.437885 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:33:00.437885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:00.483858 [debug] [ThreadPool]: SQL status: BEGIN in 0.046 seconds
[0m18:33:00.484858 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:33:00.485858 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:33:00.492853 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.006 seconds
[0m18:33:00.494851 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:33:00.494851 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:33:00.504846 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.505846 [debug] [MainThread]: On master: BEGIN
[0m18:33:00.506846 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:00.551820 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m18:33:00.551820 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.552819 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:00.563813 [debug] [MainThread]: SQL status: SELECT 3 in 0.009 seconds
[0m18:33:00.565812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12706CCE0>]}
[0m18:33:00.566811 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:00.567810 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.567810 [debug] [MainThread]: On master: BEGIN
[0m18:33:00.568810 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:33:00.569810 [debug] [MainThread]: On master: COMMIT
[0m18:33:00.570809 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:00.570809 [debug] [MainThread]: On master: COMMIT
[0m18:33:00.571808 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:00.572809 [debug] [MainThread]: On master: Close
[0m18:33:00.575806 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m18:33:00.576805 [info ] [Thread-1 (]: 1 of 5 START sql view model public.example ..................................... [RUN]
[0m18:33:00.577805 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m18:33:00.578805 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m18:33:00.586799 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m18:33:00.587799 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m18:33:00.633773 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m18:33:00.635772 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.635772 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m18:33:00.636772 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:00.684743 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:33:00.685743 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.686743 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m18:33:00.692740 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:33:00.701734 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.701734 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m18:33:00.703733 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:00.707730 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.708730 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m18:33:00.709729 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:00.729717 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:33:00.730717 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.730717 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:33:00.734716 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:33:00.743709 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m18:33:00.748706 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:33:00.749706 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop view if exists "sales_db"."public"."example__dbt_backup" cascade
[0m18:33:00.751705 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:33:00.756703 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m18:33:00.759700 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E1243076B0>]}
[0m18:33:00.760701 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.18s]
[0m18:33:00.761700 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m18:33:00.762699 [debug] [Thread-1 (]: Began running node model.my_dbt_project.order_status_summary
[0m18:33:00.763699 [info ] [Thread-1 (]: 2 of 5 START sql view model public.order_status_summary ........................ [RUN]
[0m18:33:00.764698 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.order_status_summary)
[0m18:33:00.764698 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.order_status_summary
[0m18:33:00.768695 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.order_status_summary"
[0m18:33:00.769695 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.order_status_summary
[0m18:33:00.775691 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.order_status_summary"
[0m18:33:00.776691 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.777691 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: BEGIN
[0m18:33:00.778690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.827661 [debug] [Thread-1 (]: SQL status: BEGIN in 0.049 seconds
[0m18:33:00.828662 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.829661 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */

  create view "sales_db"."public"."order_status_summary__dbt_tmp"
    
    
  as (
    -- models/marts/order_status_summary.sql

select
    status,
    count(*) as total_orders,
    sum(order_amount) as total_amount
from
    "sales_db"."public"."orders"
group by
    status
order by
    total_orders desc
  );
[0m18:33:00.836658 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:33:00.842653 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.843653 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary" rename to "order_status_summary__dbt_backup"
[0m18:33:00.844652 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:33:00.849649 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.850649 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary__dbt_tmp" rename to "order_status_summary"
[0m18:33:00.851648 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:33:00.853647 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:33:00.854646 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.854646 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:33:00.858644 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:33:00.861643 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."order_status_summary__dbt_backup"
[0m18:33:00.862642 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:33:00.862642 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
drop view if exists "sales_db"."public"."order_status_summary__dbt_backup" cascade
[0m18:33:00.864642 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:33:00.866641 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: Close
[0m18:33:00.867639 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12923BB90>]}
[0m18:33:00.869638 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.order_status_summary ................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:33:00.871638 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.order_status_summary
[0m18:33:00.873637 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_by_month
[0m18:33:00.874636 [info ] [Thread-1 (]: 3 of 5 START sql view model public.sales_by_month .............................. [RUN]
[0m18:33:00.875635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.order_status_summary, now model.my_dbt_project.sales_by_month)
[0m18:33:00.876635 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_by_month
[0m18:33:00.879632 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_by_month"
[0m18:33:00.881631 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_by_month
[0m18:33:00.885629 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_by_month"
[0m18:33:00.886629 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:00.887629 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: BEGIN
[0m18:33:00.888628 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:00.938598 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:33:00.940598 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:00.940598 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */

  create view "sales_db"."public"."sales_by_month__dbt_tmp"
    
    
  as (
    -- models/marts/sales_by_month.sql

with monthly_sales as (
    select
        date_trunc('month', order_date) as month,
        sum(order_amount) as total_sales,
        count(*) as total_orders
    from
        "sales_db"."public"."orders"
    where
        status = 'Completed'
    group by
        month
)

select
    month,
    total_sales,
    total_orders
from
    monthly_sales
order by
    month
  );
[0m18:33:00.949592 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m18:33:00.954590 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:00.955589 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month" rename to "sales_by_month__dbt_backup"
[0m18:33:00.957589 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:00.963584 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:00.964584 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month__dbt_tmp" rename to "sales_by_month"
[0m18:33:00.965583 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:01.049536 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:33:01.050535 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:01.051536 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:33:01.052534 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:33:01.057530 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."sales_by_month__dbt_backup"
[0m18:33:01.058530 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:33:01.058530 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
drop view if exists "sales_db"."public"."sales_by_month__dbt_backup" cascade
[0m18:33:01.060531 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:33:01.062529 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: Close
[0m18:33:01.063527 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12928E270>]}
[0m18:33:01.064528 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.sales_by_month ......................... [[32mCREATE VIEW[0m in 0.19s]
[0m18:33:01.066526 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_by_month
[0m18:33:01.068529 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_order_summary
[0m18:33:01.069526 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_order_summary .......................... [RUN]
[0m18:33:01.070542 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_by_month, now model.my_dbt_project.user_order_summary)
[0m18:33:01.071525 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_order_summary
[0m18:33:01.076538 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_order_summary"
[0m18:33:01.078519 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_order_summary
[0m18:33:01.082517 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_order_summary"
[0m18:33:01.083517 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:33:01.084515 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: BEGIN
[0m18:33:01.085517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:01.137485 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:33:01.138485 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:33:01.139485 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */

  create view "sales_db"."public"."user_order_summary__dbt_tmp"
    
    
  as (
    -- models/marts/user_order_summary.sql

with user_orders as (
    select
        u.id as user_id,
        u.name,
        u.email,
        o.order_amount,
        o.status,
        o.order_date
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
),

aggregated_data as (
    select
        user_id,
        name,
        email,
        count(*) as total_orders,
        sum(order_amount) as total_amount,
        max(order_date) as last_order_date
    from
        user_orders
    group by
        user_id, name, email
)

select * from aggregated_data
  );
[0m18:33:01.146480 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:33:01.150478 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:33:01.151477 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */
alter table "sales_db"."public"."user_order_summary__dbt_tmp" rename to "user_order_summary"
[0m18:33:01.152476 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:01.154475 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: COMMIT
[0m18:33:01.154475 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:33:01.155475 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: COMMIT
[0m18:33:01.157474 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:33:01.160471 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."user_order_summary__dbt_backup"
[0m18:33:01.161471 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:33:01.161471 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */
drop view if exists "sales_db"."public"."user_order_summary__dbt_backup" cascade
[0m18:33:01.162470 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:33:01.164471 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: Close
[0m18:33:01.165469 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E12863C920>]}
[0m18:33:01.167468 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.user_order_summary ..................... [[32mCREATE VIEW[0m in 0.09s]
[0m18:33:01.168468 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_order_summary
[0m18:33:01.169469 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_segmentation
[0m18:33:01.170468 [info ] [Thread-1 (]: 5 of 5 START sql view model public.user_segmentation ........................... [RUN]
[0m18:33:01.172466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.user_order_summary, now model.my_dbt_project.user_segmentation)
[0m18:33:01.173465 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_segmentation
[0m18:33:01.179461 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_segmentation"
[0m18:33:01.181461 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_segmentation
[0m18:33:01.187457 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_segmentation"
[0m18:33:01.189458 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:33:01.190455 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: BEGIN
[0m18:33:01.190455 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:01.250421 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m18:33:01.251422 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:33:01.252422 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */

  create view "sales_db"."public"."user_segmentation__dbt_tmp"
    
    
  as (
    -- models/marts/user_segmentation.sql

with user_rfm as (
    select
        u.id as user_id,
        u.name,
        u.email,
        max(o.order_date) as last_order_date,
        count(*) as total_orders,
        sum(o.order_amount) as total_spent
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
    group by
        u.id, u.name, u.email
),

user_segments as (
    select
        user_id,
        name,
        email,
        last_order_date,
        total_orders,
        total_spent,
        case
            when total_spent > 1000 then 'High Value'
            when total_spent between 500 and 1000 then 'Medium Value'
            else 'Low Value'
        end as value_segment
    from
        user_rfm
)

select * from user_segments
  );
[0m18:33:01.266412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m18:33:01.273408 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:33:01.274407 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */
alter table "sales_db"."public"."user_segmentation__dbt_tmp" rename to "user_segmentation"
[0m18:33:01.276406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:33:01.279405 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: COMMIT
[0m18:33:01.281404 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:33:01.281404 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: COMMIT
[0m18:33:01.285401 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:33:01.290398 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."user_segmentation__dbt_backup"
[0m18:33:01.292398 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:33:01.293397 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */
drop view if exists "sales_db"."public"."user_segmentation__dbt_backup" cascade
[0m18:33:01.294395 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.000 seconds
[0m18:33:01.296395 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: Close
[0m18:33:01.297394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '86477af3-c867-4d71-a22a-901ef042071d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E128804950>]}
[0m18:33:01.298394 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.user_segmentation ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m18:33:01.300393 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_segmentation
[0m18:33:01.302391 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.303390 [debug] [MainThread]: On master: BEGIN
[0m18:33:01.304390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:01.356361 [debug] [MainThread]: SQL status: BEGIN in 0.052 seconds
[0m18:33:01.357359 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.357359 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:01.358360 [debug] [MainThread]: On master: COMMIT
[0m18:33:01.359358 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:01.359358 [debug] [MainThread]: On master: Close
[0m18:33:01.360358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:01.361357 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m18:33:01.362357 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:33:01.363356 [debug] [MainThread]: Connection 'model.my_dbt_project.user_segmentation' was properly closed.
[0m18:33:01.364355 [info ] [MainThread]: 
[0m18:33:01.365355 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.12 seconds (1.12s).
[0m18:33:01.367354 [debug] [MainThread]: Command end result
[0m18:33:01.400335 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:33:01.403334 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:33:01.411328 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:33:01.412328 [info ] [MainThread]: 
[0m18:33:01.413328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:33:01.415328 [info ] [MainThread]: 
[0m18:33:01.416326 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:33:01.419324 [debug] [MainThread]: Command `dbt run` succeeded at 18:33:01.418326 after 3.43 seconds
[0m18:33:01.419324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126A2D850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126A2E810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E126A2C2F0>]}
[0m18:33:01.420323 [debug] [MainThread]: Flushing usage events
[0m18:33:01.942025 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:33:16.533693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156CF8C20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156E231D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156C82360>]}


============================== 18:33:16.540689 | cd5a413d-50ff-4fb4-bc82-cc5696f98849 ==============================
[0m18:33:16.540689 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:33:16.541688 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:33:16.834521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271572EF590>]}
[0m18:33:16.933464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156AD4FE0>]}
[0m18:33:16.935463 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:33:17.252282 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:33:17.463161 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:33:17.463161 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:33:17.470157 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:33:17.532122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271587FFFB0>]}
[0m18:33:17.642059 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:33:17.647057 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:33:17.696029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002715750C200>]}
[0m18:33:17.696029 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:33:17.697028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156E54E30>]}
[0m18:33:17.701027 [info ] [MainThread]: 
[0m18:33:17.702027 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:33:17.703025 [info ] [MainThread]: 
[0m18:33:17.704024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:33:17.709021 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:33:17.802970 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:33:17.802970 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:33:17.803970 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:33:17.862933 [debug] [ThreadPool]: SQL status: BEGIN in 0.059 seconds
[0m18:33:17.863934 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:33:17.864933 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:33:17.871930 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.006 seconds
[0m18:33:17.873927 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:33:17.873927 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:33:17.888919 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.889919 [debug] [MainThread]: On master: BEGIN
[0m18:33:17.889919 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:33:17.943889 [debug] [MainThread]: SQL status: BEGIN in 0.054 seconds
[0m18:33:17.944887 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.945886 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:33:17.954881 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m18:33:17.959878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd5a413d-50ff-4fb4-bc82-cc5696f98849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271572ECD10>]}
[0m18:33:17.960877 [debug] [MainThread]: On master: ROLLBACK
[0m18:33:17.961878 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.961878 [debug] [MainThread]: On master: BEGIN
[0m18:33:17.962876 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:33:17.962876 [debug] [MainThread]: On master: COMMIT
[0m18:33:17.963876 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:17.963876 [debug] [MainThread]: On master: COMMIT
[0m18:33:17.964876 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:17.965875 [debug] [MainThread]: On master: Close
[0m18:33:17.968873 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:33:17.969872 [info ] [Thread-1 (]: 1 of 17 START test not_null_example_email ...................................... [RUN]
[0m18:33:17.970873 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_example_email.f6780dacc6'
[0m18:33:17.971872 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:33:17.998856 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:33:18.000856 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:33:18.024841 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:33:18.025840 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:33:18.026841 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: BEGIN
[0m18:33:18.027840 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:33:18.072815 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:33:18.073814 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:33:18.074812 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_email.f6780dacc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "sales_db"."public"."example"
where email is null



      
    ) dbt_internal_test
[0m18:33:18.078811 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:33:18.083807 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: ROLLBACK
[0m18:33:18.084808 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: Close
[0m18:33:18.085806 [info ] [Thread-1 (]: 1 of 17 PASS not_null_example_email ............................................ [[32mPASS[0m in 0.11s]
[0m18:33:18.087806 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:33:18.088805 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:33:18.089804 [info ] [Thread-1 (]: 2 of 17 START test not_null_example_id ......................................... [RUN]
[0m18:33:18.090804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m18:33:18.091803 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:33:18.099798 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:33:18.102797 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:33:18.109792 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:33:18.110793 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:33:18.111791 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: BEGIN
[0m18:33:18.112791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.164761 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m18:33:18.165761 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:33:18.166760 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_id.96691fbe5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sales_db"."public"."example"
where id is null



      
    ) dbt_internal_test
[0m18:33:18.170757 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:33:18.173757 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: ROLLBACK
[0m18:33:18.174756 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: Close
[0m18:33:18.174756 [info ] [Thread-1 (]: 2 of 17 PASS not_null_example_id ............................................... [[32mPASS[0m in 0.08s]
[0m18:33:18.176756 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:33:18.177755 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:33:18.178755 [info ] [Thread-1 (]: 3 of 17 START test not_null_order_status_summary_status ........................ [RUN]
[0m18:33:18.179753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb)
[0m18:33:18.180752 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:33:18.188747 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:33:18.190747 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:33:18.194745 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:33:18.196743 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:33:18.197744 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: BEGIN
[0m18:33:18.197744 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.248714 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:33:18.249713 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:33:18.250712 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from "sales_db"."public"."order_status_summary"
where status is null



      
    ) dbt_internal_test
[0m18:33:18.253711 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:33:18.256709 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: ROLLBACK
[0m18:33:18.257708 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: Close
[0m18:33:18.258709 [info ] [Thread-1 (]: 3 of 17 PASS not_null_order_status_summary_status .............................. [[32mPASS[0m in 0.08s]
[0m18:33:18.260707 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:33:18.261706 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:33:18.262705 [info ] [Thread-1 (]: 4 of 17 START test not_null_order_status_summary_total_amount .................. [RUN]
[0m18:33:18.263705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb, now test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75)
[0m18:33:18.263705 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:33:18.269702 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:33:18.271700 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:33:18.274700 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:33:18.276698 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:33:18.277697 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: BEGIN
[0m18:33:18.278696 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.337664 [debug] [Thread-1 (]: SQL status: BEGIN in 0.060 seconds
[0m18:33:18.338662 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:33:18.339661 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "sales_db"."public"."order_status_summary"
where total_amount is null



      
    ) dbt_internal_test
[0m18:33:18.342660 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:33:18.344659 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: ROLLBACK
[0m18:33:18.345658 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: Close
[0m18:33:18.346657 [info ] [Thread-1 (]: 4 of 17 PASS not_null_order_status_summary_total_amount ........................ [[32mPASS[0m in 0.08s]
[0m18:33:18.348657 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:33:18.349661 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:33:18.350655 [info ] [Thread-1 (]: 5 of 17 START test not_null_order_status_summary_total_orders .................. [RUN]
[0m18:33:18.352655 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75, now test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280)
[0m18:33:18.352655 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:33:18.357650 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:33:18.358650 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:33:18.363649 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:33:18.365646 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:33:18.366646 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: BEGIN
[0m18:33:18.368648 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.418617 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:33:18.418617 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:33:18.419616 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."order_status_summary"
where total_orders is null



      
    ) dbt_internal_test
[0m18:33:18.422614 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:33:18.424613 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: ROLLBACK
[0m18:33:18.425612 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: Close
[0m18:33:18.427611 [info ] [Thread-1 (]: 5 of 17 PASS not_null_order_status_summary_total_orders ........................ [[32mPASS[0m in 0.07s]
[0m18:33:18.429611 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:33:18.430617 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:33:18.431609 [info ] [Thread-1 (]: 6 of 17 START test not_null_sales_by_month_month ............................... [RUN]
[0m18:33:18.432608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280, now test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a)
[0m18:33:18.433608 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:33:18.438605 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:33:18.440605 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:33:18.442604 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:33:18.444601 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:33:18.445602 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: BEGIN
[0m18:33:18.446600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.499570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:33:18.500569 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:33:18.501569 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from "sales_db"."public"."sales_by_month"
where month is null



      
    ) dbt_internal_test
[0m18:33:18.504568 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:33:18.507565 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: ROLLBACK
[0m18:33:18.508564 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: Close
[0m18:33:18.509565 [info ] [Thread-1 (]: 6 of 17 PASS not_null_sales_by_month_month ..................................... [[32mPASS[0m in 0.08s]
[0m18:33:18.511564 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:33:18.512569 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:33:18.513563 [info ] [Thread-1 (]: 7 of 17 START test not_null_sales_by_month_total_orders ........................ [RUN]
[0m18:33:18.514563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a, now test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f)
[0m18:33:18.515561 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:33:18.521557 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:33:18.522557 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:33:18.526554 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:33:18.528554 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:33:18.529553 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: BEGIN
[0m18:33:18.530552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.587520 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:33:18.588519 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:33:18.589518 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."sales_by_month"
where total_orders is null



      
    ) dbt_internal_test
[0m18:33:18.594515 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:33:18.596516 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: ROLLBACK
[0m18:33:18.597515 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: Close
[0m18:33:18.599513 [info ] [Thread-1 (]: 7 of 17 PASS not_null_sales_by_month_total_orders .............................. [[32mPASS[0m in 0.08s]
[0m18:33:18.601513 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:33:18.603511 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:33:18.603511 [info ] [Thread-1 (]: 8 of 17 START test not_null_sales_by_month_total_sales ......................... [RUN]
[0m18:33:18.605510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f, now test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2)
[0m18:33:18.605510 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:33:18.611506 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:33:18.612507 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:33:18.618510 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:33:18.620501 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:33:18.621501 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: BEGIN
[0m18:33:18.622501 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.677470 [debug] [Thread-1 (]: SQL status: BEGIN in 0.055 seconds
[0m18:33:18.678469 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:33:18.679468 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_sales
from "sales_db"."public"."sales_by_month"
where total_sales is null



      
    ) dbt_internal_test
[0m18:33:18.682467 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:33:18.685464 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: ROLLBACK
[0m18:33:18.687464 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: Close
[0m18:33:18.688463 [info ] [Thread-1 (]: 8 of 17 PASS not_null_sales_by_month_total_sales ............................... [[32mPASS[0m in 0.08s]
[0m18:33:18.690463 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:33:18.692461 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:33:18.693460 [info ] [Thread-1 (]: 9 of 17 START test not_null_user_order_summary_total_amount .................... [RUN]
[0m18:33:18.694459 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2, now test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6)
[0m18:33:18.695459 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:33:18.701455 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:33:18.703454 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:33:18.707452 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:33:18.709450 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:33:18.710450 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: BEGIN
[0m18:33:18.711451 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.765420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.054 seconds
[0m18:33:18.766419 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:33:18.767418 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "sales_db"."public"."user_order_summary"
where total_amount is null



      
    ) dbt_internal_test
[0m18:33:18.774415 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:33:18.777411 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: ROLLBACK
[0m18:33:18.778411 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: Close
[0m18:33:18.780410 [error] [Thread-1 (]: 9 of 17 FAIL 40 not_null_user_order_summary_total_amount ....................... [[31mFAIL 40[0m in 0.08s]
[0m18:33:18.782410 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:33:18.784409 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:33:18.785408 [info ] [Thread-1 (]: 10 of 17 START test not_null_user_order_summary_total_orders ................... [RUN]
[0m18:33:18.786407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6, now test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c)
[0m18:33:18.786407 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:33:18.793404 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:33:18.794403 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:33:18.797401 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:33:18.799401 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:33:18.801399 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: BEGIN
[0m18:33:18.802398 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.847373 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:33:18.849370 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:33:18.849370 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."user_order_summary"
where total_orders is null



      
    ) dbt_internal_test
[0m18:33:18.854368 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:33:18.856366 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: ROLLBACK
[0m18:33:18.857366 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: Close
[0m18:33:18.858365 [info ] [Thread-1 (]: 10 of 17 PASS not_null_user_order_summary_total_orders ......................... [[32mPASS[0m in 0.07s]
[0m18:33:18.860365 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:33:18.861365 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:33:18.862364 [info ] [Thread-1 (]: 11 of 17 START test not_null_user_order_summary_user_id ........................ [RUN]
[0m18:33:18.863363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c, now test.my_dbt_project.not_null_user_order_summary_user_id.744111b232)
[0m18:33:18.864362 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:33:18.870358 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:33:18.871359 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:33:18.874356 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:33:18.876355 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:33:18.878354 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: BEGIN
[0m18:33:18.879353 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:18.928326 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:33:18.929324 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:33:18.930324 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "sales_db"."public"."user_order_summary"
where user_id is null



      
    ) dbt_internal_test
[0m18:33:18.935322 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:33:18.937320 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: ROLLBACK
[0m18:33:18.938319 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: Close
[0m18:33:18.939319 [info ] [Thread-1 (]: 11 of 17 PASS not_null_user_order_summary_user_id .............................. [[32mPASS[0m in 0.08s]
[0m18:33:18.941318 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:33:18.942318 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:33:18.943318 [info ] [Thread-1 (]: 12 of 17 START test not_null_user_segmentation_frequency_segment ............... [RUN]
[0m18:33:18.944316 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_user_id.744111b232, now test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7)
[0m18:33:18.945316 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:33:18.953310 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:33:18.955311 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:33:18.959308 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:33:18.960307 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:33:18.961307 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: BEGIN
[0m18:33:18.962306 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.014276 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m18:33:19.015275 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:33:19.016276 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select frequency_segment
from "sales_db"."public"."user_segmentation"
where frequency_segment is null



      
    ) dbt_internal_test
[0m18:33:19.018275 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « frequency_segment » n'existe pas
LINE 13: select frequency_segment
                ^

[0m18:33:19.018275 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: ROLLBACK
[0m18:33:19.019274 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: Close
[0m18:33:19.042260 [debug] [Thread-1 (]: Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql
[0m18:33:19.043260 [error] [Thread-1 (]: 12 of 17 ERROR not_null_user_segmentation_frequency_segment .................... [[31mERROR[0m in 0.10s]
[0m18:33:19.045259 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:33:19.046258 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:33:19.047257 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql.
[0m18:33:19.047257 [info ] [Thread-1 (]: 13 of 17 START test not_null_user_segmentation_user_id ......................... [RUN]
[0m18:33:19.049257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7, now test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3)
[0m18:33:19.050258 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:33:19.055253 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:33:19.057252 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:33:19.060250 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:33:19.061250 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:33:19.062249 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: BEGIN
[0m18:33:19.063249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.116218 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:33:19.117218 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:33:19.118217 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "sales_db"."public"."user_segmentation"
where user_id is null



      
    ) dbt_internal_test
[0m18:33:19.122216 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:33:19.124213 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: ROLLBACK
[0m18:33:19.125213 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: Close
[0m18:33:19.126212 [info ] [Thread-1 (]: 13 of 17 PASS not_null_user_segmentation_user_id ............................... [[32mPASS[0m in 0.08s]
[0m18:33:19.128212 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:33:19.129211 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:33:19.130211 [info ] [Thread-1 (]: 14 of 17 START test not_null_user_segmentation_value_segment ................... [RUN]
[0m18:33:19.131210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3, now test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8)
[0m18:33:19.131210 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:33:19.137206 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:33:19.139205 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:33:19.148200 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:33:19.151199 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:33:19.152200 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: BEGIN
[0m18:33:19.153197 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.201171 [debug] [Thread-1 (]: SQL status: BEGIN in 0.047 seconds
[0m18:33:19.201171 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:33:19.202170 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_segment
from "sales_db"."public"."user_segmentation"
where value_segment is null



      
    ) dbt_internal_test
[0m18:33:19.208165 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:33:19.211163 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: ROLLBACK
[0m18:33:19.212163 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: Close
[0m18:33:19.213163 [info ] [Thread-1 (]: 14 of 17 PASS not_null_user_segmentation_value_segment ......................... [[32mPASS[0m in 0.08s]
[0m18:33:19.215162 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:33:19.216161 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:33:19.217160 [info ] [Thread-1 (]: 15 of 17 START test unique_example_id .......................................... [RUN]
[0m18:33:19.218161 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m18:33:19.219160 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:33:19.231152 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:33:19.233152 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:33:19.238148 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:33:19.240147 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:33:19.241147 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: BEGIN
[0m18:33:19.241147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.290119 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:33:19.291118 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:33:19.291118 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_example_id.50f543cf6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sales_db"."public"."example"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:19.295117 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:33:19.297115 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: ROLLBACK
[0m18:33:19.298115 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: Close
[0m18:33:19.299113 [info ] [Thread-1 (]: 15 of 17 PASS unique_example_id ................................................ [[32mPASS[0m in 0.08s]
[0m18:33:19.301114 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:33:19.302112 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:33:19.304111 [info ] [Thread-1 (]: 16 of 17 START test unique_user_order_summary_user_id .......................... [RUN]
[0m18:33:19.304111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_example_id.50f543cf6e, now test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04)
[0m18:33:19.305111 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:33:19.309107 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:33:19.311107 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:33:19.314105 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:33:19.315104 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:33:19.316103 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: BEGIN
[0m18:33:19.317104 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.374071 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m18:33:19.375070 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:33:19.376070 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "sales_db"."public"."user_order_summary"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:19.383066 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.006 seconds
[0m18:33:19.386064 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: ROLLBACK
[0m18:33:19.387063 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: Close
[0m18:33:19.389063 [info ] [Thread-1 (]: 16 of 17 PASS unique_user_order_summary_user_id ................................ [[32mPASS[0m in 0.08s]
[0m18:33:19.391062 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:33:19.392073 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:33:19.393061 [info ] [Thread-1 (]: 17 of 17 START test unique_user_segmentation_user_id ........................... [RUN]
[0m18:33:19.394060 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04, now test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd)
[0m18:33:19.395060 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:33:19.401055 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:33:19.403055 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:33:19.409052 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:33:19.411050 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:33:19.412050 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: BEGIN
[0m18:33:19.413049 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:33:19.470017 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:33:19.471015 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:33:19.472015 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "sales_db"."public"."user_segmentation"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:33:19.478011 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:33:19.480010 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: ROLLBACK
[0m18:33:19.481011 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: Close
[0m18:33:19.482009 [info ] [Thread-1 (]: 17 of 17 PASS unique_user_segmentation_user_id ................................. [[32mPASS[0m in 0.09s]
[0m18:33:19.485014 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:33:19.487007 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:19.488006 [debug] [MainThread]: On master: BEGIN
[0m18:33:19.488006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:33:19.536978 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m18:33:19.537977 [debug] [MainThread]: On master: COMMIT
[0m18:33:19.538976 [debug] [MainThread]: Using postgres connection "master"
[0m18:33:19.539976 [debug] [MainThread]: On master: COMMIT
[0m18:33:19.540976 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:33:19.540976 [debug] [MainThread]: On master: Close
[0m18:33:19.541976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:33:19.542975 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:33:19.542975 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd' was properly closed.
[0m18:33:19.543974 [info ] [MainThread]: 
[0m18:33:19.544973 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.84 seconds (1.84s).
[0m18:33:19.551969 [debug] [MainThread]: Command end result
[0m18:33:19.587948 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:33:19.590946 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:33:19.599942 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:33:19.600941 [info ] [MainThread]: 
[0m18:33:19.601940 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:33:19.603947 [info ] [MainThread]: 
[0m18:33:19.604939 [error] [MainThread]: [31mFailure in test not_null_user_order_summary_total_amount (models\schema.yaml)[0m
[0m18:33:19.605939 [error] [MainThread]:   Got 40 results, configured to fail if != 0
[0m18:33:19.606939 [info ] [MainThread]: 
[0m18:33:19.607939 [info ] [MainThread]:   compiled code at target\compiled\my_dbt_project\models\schema.yaml\not_null_user_order_summary_total_amount.sql
[0m18:33:19.608936 [info ] [MainThread]: 
[0m18:33:19.609936 [error] [MainThread]:   Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql
[0m18:33:19.610935 [info ] [MainThread]: 
[0m18:33:19.612935 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m18:33:19.614933 [debug] [MainThread]: Command `dbt test` failed at 18:33:19.614933 after 3.24 seconds
[0m18:33:19.615932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027156E231D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271568E2FC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000271568E3800>]}
[0m18:33:19.616932 [debug] [MainThread]: Flushing usage events
[0m18:33:20.050684 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:18.050563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE4331310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE6ACF560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE6ACD730>]}


============================== 18:34:18.055560 | 299a7520-aa61-41b8-853d-389b37b4d262 ==============================
[0m18:34:18.055560 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:34:18.056559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:18.289427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '299a7520-aa61-41b8-853d-389b37b4d262', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE7005BE0>]}
[0m18:34:18.347394 [debug] [MainThread]: Command `dbt clean` succeeded at 18:34:18.346393 after 0.47 seconds
[0m18:34:18.348394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE6CF4320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE6CF54C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018AE68A7500>]}
[0m18:34:18.349392 [debug] [MainThread]: Flushing usage events
[0m18:34:18.792141 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:22.360101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F9C4BF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F9C4B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F9C4950>]}


============================== 18:34:22.365098 | 8f9f6123-25d3-495a-b7fe-3cb37c982179 ==============================
[0m18:34:22.365098 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:34:22.367100 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:34:22.685917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F9C4B30>]}
[0m18:34:22.801849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475EEFFB00>]}
[0m18:34:22.803848 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:34:23.120668 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:34:23.121668 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m18:34:23.122667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475F7488C0>]}
[0m18:34:25.026581 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:34:25.041569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476130D5E0>]}
[0m18:34:25.160502 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:34:25.169515 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:34:25.206476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247611D1910>]}
[0m18:34:25.207475 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:34:25.208474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024761192C00>]}
[0m18:34:25.213472 [info ] [MainThread]: 
[0m18:34:25.214471 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:25.216491 [info ] [MainThread]: 
[0m18:34:25.217469 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:25.221467 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db'
[0m18:34:25.316415 [debug] [ThreadPool]: Using postgres connection "list_sales_db"
[0m18:34:25.316415 [debug] [ThreadPool]: On list_sales_db: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db"} */

    select distinct nspname from pg_namespace
  
[0m18:34:25.317414 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:25.373380 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.056 seconds
[0m18:34:25.374380 [debug] [ThreadPool]: On list_sales_db: Close
[0m18:34:25.377379 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:34:25.385373 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:34:25.385373 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:34:25.386373 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:25.436345 [debug] [ThreadPool]: SQL status: BEGIN in 0.050 seconds
[0m18:34:25.437344 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:34:25.438343 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:34:25.447338 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:34:25.450336 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:34:25.451335 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:34:25.462329 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:25.463329 [debug] [MainThread]: On master: BEGIN
[0m18:34:25.464328 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:25.515300 [debug] [MainThread]: SQL status: BEGIN in 0.051 seconds
[0m18:34:25.516300 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:25.517298 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:25.526293 [debug] [MainThread]: SQL status: SELECT 7 in 0.008 seconds
[0m18:34:25.530292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024761190FB0>]}
[0m18:34:25.531290 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:25.532290 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:25.533289 [debug] [MainThread]: On master: BEGIN
[0m18:34:25.533289 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:34:25.534289 [debug] [MainThread]: On master: COMMIT
[0m18:34:25.534289 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:25.535288 [debug] [MainThread]: On master: COMMIT
[0m18:34:25.536288 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:25.536288 [debug] [MainThread]: On master: Close
[0m18:34:25.539287 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m18:34:25.541285 [info ] [Thread-1 (]: 1 of 5 START sql view model public.example ..................................... [RUN]
[0m18:34:25.542284 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m18:34:25.543283 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m18:34:25.557276 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m18:34:25.560274 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m18:34:25.606248 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.example"
[0m18:34:25.609247 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.610245 [debug] [Thread-1 (]: On model.my_dbt_project.example: BEGIN
[0m18:34:25.611244 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:25.673209 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m18:34:25.674209 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.675208 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */

  create view "sales_db"."public"."example__dbt_tmp"
    
    
  as (
    -- dbt model example.sql

with raw_users as (
    -- Sélection des données brutes
    select
        id,
        name,
        email,
        is_active,
        created_at
    from
        public.users
),

active_users as (
    -- Filtrer les utilisateurs actifs
    select
        id,
        name,
        email,
        created_at
    from
        raw_users
    where
        is_active = true
)

-- Résultat final
select
    id,
    name,
    email,
    date_trunc('month', created_at) as signup_month
from
    active_users
  );
[0m18:34:25.681205 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m18:34:25.690199 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.691199 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example" rename to "example__dbt_backup"
[0m18:34:25.692198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:25.696196 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.696196 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
alter table "sales_db"."public"."example__dbt_tmp" rename to "example"
[0m18:34:25.697196 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:25.727179 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:34:25.729178 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.729178 [debug] [Thread-1 (]: On model.my_dbt_project.example: COMMIT
[0m18:34:25.733177 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m18:34:25.742169 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."example__dbt_backup"
[0m18:34:25.748166 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.example"
[0m18:34:25.750166 [debug] [Thread-1 (]: On model.my_dbt_project.example: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.example"} */
drop view if exists "sales_db"."public"."example__dbt_backup" cascade
[0m18:34:25.753165 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:34:25.756163 [debug] [Thread-1 (]: On model.my_dbt_project.example: Close
[0m18:34:25.759160 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475CDF7500>]}
[0m18:34:25.762158 [info ] [Thread-1 (]: 1 of 5 OK created sql view model public.example ................................ [[32mCREATE VIEW[0m in 0.21s]
[0m18:34:25.764158 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m18:34:25.766158 [debug] [Thread-1 (]: Began running node model.my_dbt_project.order_status_summary
[0m18:34:25.767156 [info ] [Thread-1 (]: 2 of 5 START sql view model public.order_status_summary ........................ [RUN]
[0m18:34:25.768156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.order_status_summary)
[0m18:34:25.769155 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.order_status_summary
[0m18:34:25.775151 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.order_status_summary"
[0m18:34:25.776150 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.order_status_summary
[0m18:34:25.783149 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.order_status_summary"
[0m18:34:25.786145 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.787144 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: BEGIN
[0m18:34:25.787144 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:25.839115 [debug] [Thread-1 (]: SQL status: BEGIN in 0.052 seconds
[0m18:34:25.840115 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.841115 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */

  create view "sales_db"."public"."order_status_summary__dbt_tmp"
    
    
  as (
    -- models/marts/order_status_summary.sql

select
    status,
    count(*) as total_orders,
    sum(order_amount) as total_amount
from
    "sales_db"."public"."orders"
group by
    status
order by
    total_orders desc
  );
[0m18:34:25.847109 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:34:25.852106 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.853107 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary" rename to "order_status_summary__dbt_backup"
[0m18:34:25.854106 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:34:25.857104 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.858104 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
alter table "sales_db"."public"."order_status_summary__dbt_tmp" rename to "order_status_summary"
[0m18:34:25.859103 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:34:25.861102 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:34:25.861102 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.862101 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: COMMIT
[0m18:34:25.865099 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:25.869099 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."order_status_summary__dbt_backup"
[0m18:34:25.871097 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.order_status_summary"
[0m18:34:25.871097 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.order_status_summary"} */
drop view if exists "sales_db"."public"."order_status_summary__dbt_backup" cascade
[0m18:34:25.873096 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:34:25.875094 [debug] [Thread-1 (]: On model.my_dbt_project.order_status_summary: Close
[0m18:34:25.876093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247617796D0>]}
[0m18:34:25.877093 [info ] [Thread-1 (]: 2 of 5 OK created sql view model public.order_status_summary ................... [[32mCREATE VIEW[0m in 0.11s]
[0m18:34:25.878095 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.order_status_summary
[0m18:34:25.880094 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_by_month
[0m18:34:25.881090 [info ] [Thread-1 (]: 3 of 5 START sql view model public.sales_by_month .............................. [RUN]
[0m18:34:25.883091 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.order_status_summary, now model.my_dbt_project.sales_by_month)
[0m18:34:25.884089 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_by_month
[0m18:34:25.889086 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_by_month"
[0m18:34:25.891085 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_by_month
[0m18:34:25.895082 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.sales_by_month"
[0m18:34:25.897082 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.898080 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: BEGIN
[0m18:34:25.899082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:25.949054 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:34:25.950052 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.951051 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */

  create view "sales_db"."public"."sales_by_month__dbt_tmp"
    
    
  as (
    -- models/marts/sales_by_month.sql

with monthly_sales as (
    select
        date_trunc('month', order_date) as month,
        sum(order_amount) as total_sales,
        count(*) as total_orders
    from
        "sales_db"."public"."orders"
    where
        status = 'Completed'
    group by
        month
)

select
    month,
    total_sales,
    total_orders
from
    monthly_sales
order by
    month
  );
[0m18:34:25.958046 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m18:34:25.962044 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.963044 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month" rename to "sales_by_month__dbt_backup"
[0m18:34:25.964043 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:25.968041 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.969040 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
alter table "sales_db"."public"."sales_by_month__dbt_tmp" rename to "sales_by_month"
[0m18:34:25.970041 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m18:34:25.972039 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:34:25.973038 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.973038 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: COMMIT
[0m18:34:25.976036 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:25.979035 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."sales_by_month__dbt_backup"
[0m18:34:25.980034 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.sales_by_month"
[0m18:34:25.981033 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.sales_by_month"} */
drop view if exists "sales_db"."public"."sales_by_month__dbt_backup" cascade
[0m18:34:25.983032 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:34:25.986030 [debug] [Thread-1 (]: On model.my_dbt_project.sales_by_month: Close
[0m18:34:25.987031 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247617B0530>]}
[0m18:34:25.989029 [info ] [Thread-1 (]: 3 of 5 OK created sql view model public.sales_by_month ......................... [[32mCREATE VIEW[0m in 0.10s]
[0m18:34:25.991029 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_by_month
[0m18:34:25.992028 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_order_summary
[0m18:34:25.993027 [info ] [Thread-1 (]: 4 of 5 START sql view model public.user_order_summary .......................... [RUN]
[0m18:34:25.994026 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_by_month, now model.my_dbt_project.user_order_summary)
[0m18:34:25.995027 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_order_summary
[0m18:34:26.000023 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_order_summary"
[0m18:34:26.001022 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_order_summary
[0m18:34:26.005021 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_order_summary"
[0m18:34:26.007019 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.008018 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: BEGIN
[0m18:34:26.008018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:26.066985 [debug] [Thread-1 (]: SQL status: BEGIN in 0.059 seconds
[0m18:34:26.067985 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.068984 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */

  create view "sales_db"."public"."user_order_summary__dbt_tmp"
    
    
  as (
    -- models/marts/user_order_summary.sql

with user_orders as (
    select
        u.id as user_id,
        u.name,
        u.email,
        o.order_amount,
        o.status,
        o.order_date
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
),

aggregated_data as (
    select
        user_id,
        name,
        email,
        count(*) as total_orders,
        sum(order_amount) as total_amount,
        max(order_date) as last_order_date
    from
        user_orders
    group by
        user_id, name, email
)

select * from aggregated_data
  );
[0m18:34:26.078979 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.009 seconds
[0m18:34:26.090971 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.091970 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */
alter table "sales_db"."public"."user_order_summary" rename to "user_order_summary__dbt_backup"
[0m18:34:26.093969 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:26.098967 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.100965 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */
alter table "sales_db"."public"."user_order_summary__dbt_tmp" rename to "user_order_summary"
[0m18:34:26.101965 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:26.104964 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: COMMIT
[0m18:34:26.105963 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.106961 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: COMMIT
[0m18:34:26.108961 [debug] [Thread-1 (]: SQL status: COMMIT in 0.001 seconds
[0m18:34:26.111959 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."user_order_summary__dbt_backup"
[0m18:34:26.112958 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_order_summary"
[0m18:34:26.113960 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_order_summary"} */
drop view if exists "sales_db"."public"."user_order_summary__dbt_backup" cascade
[0m18:34:26.116956 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m18:34:26.119955 [debug] [Thread-1 (]: On model.my_dbt_project.user_order_summary: Close
[0m18:34:26.120953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476189FB00>]}
[0m18:34:26.122953 [info ] [Thread-1 (]: 4 of 5 OK created sql view model public.user_order_summary ..................... [[32mCREATE VIEW[0m in 0.13s]
[0m18:34:26.124952 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_order_summary
[0m18:34:26.125952 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_segmentation
[0m18:34:26.127951 [info ] [Thread-1 (]: 5 of 5 START sql view model public.user_segmentation ........................... [RUN]
[0m18:34:26.128950 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.user_order_summary, now model.my_dbt_project.user_segmentation)
[0m18:34:26.129949 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_segmentation
[0m18:34:26.137946 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_segmentation"
[0m18:34:26.139944 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_segmentation
[0m18:34:26.148947 [debug] [Thread-1 (]: Writing runtime sql for node "model.my_dbt_project.user_segmentation"
[0m18:34:26.151936 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.152935 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: BEGIN
[0m18:34:26.153935 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:26.215901 [debug] [Thread-1 (]: SQL status: BEGIN in 0.062 seconds
[0m18:34:26.215901 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.216899 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */

  create view "sales_db"."public"."user_segmentation__dbt_tmp"
    
    
  as (
    -- models/marts/user_segmentation.sql

with user_rfm as (
    select
        u.id as user_id,
        u.name,
        u.email,
        max(o.order_date) as last_order_date,
        count(*) as total_orders,
        sum(o.order_amount) as total_spent
    from
        "sales_db"."public"."users" u
    left join
        "sales_db"."public"."orders" o
    on
        u.id = o.user_id
    group by
        u.id, u.name, u.email
),

user_segments as (
    select
        user_id,
        name,
        email,
        last_order_date,
        total_orders,
        total_spent,
        case
            when total_spent > 1000 then 'High Value'
            when total_spent between 500 and 1000 then 'Medium Value'
            else 'Low Value'
        end as value_segment
    from
        user_rfm
)

select * from user_segments
  );
[0m18:34:26.224895 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m18:34:26.231891 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.232890 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */
alter table "sales_db"."public"."user_segmentation" rename to "user_segmentation__dbt_backup"
[0m18:34:26.234889 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:26.237887 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.238886 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */
alter table "sales_db"."public"."user_segmentation__dbt_tmp" rename to "user_segmentation"
[0m18:34:26.239887 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m18:34:26.242884 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: COMMIT
[0m18:34:26.242884 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.243883 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: COMMIT
[0m18:34:26.246881 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m18:34:26.250880 [debug] [Thread-1 (]: Applying DROP to: "sales_db"."public"."user_segmentation__dbt_backup"
[0m18:34:26.251880 [debug] [Thread-1 (]: Using postgres connection "model.my_dbt_project.user_segmentation"
[0m18:34:26.252879 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "model.my_dbt_project.user_segmentation"} */
drop view if exists "sales_db"."public"."user_segmentation__dbt_backup" cascade
[0m18:34:26.254878 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m18:34:26.257875 [debug] [Thread-1 (]: On model.my_dbt_project.user_segmentation: Close
[0m18:34:26.258875 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8f9f6123-25d3-495a-b7fe-3cb37c982179', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475CDF7500>]}
[0m18:34:26.259875 [info ] [Thread-1 (]: 5 of 5 OK created sql view model public.user_segmentation ...................... [[32mCREATE VIEW[0m in 0.13s]
[0m18:34:26.261874 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_segmentation
[0m18:34:26.263872 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.265872 [debug] [MainThread]: On master: BEGIN
[0m18:34:26.266870 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:26.315843 [debug] [MainThread]: SQL status: BEGIN in 0.049 seconds
[0m18:34:26.316842 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.316842 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:26.317841 [debug] [MainThread]: On master: COMMIT
[0m18:34:26.318841 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:26.318841 [debug] [MainThread]: On master: Close
[0m18:34:26.319840 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:26.320841 [debug] [MainThread]: Connection 'list_sales_db' was properly closed.
[0m18:34:26.320841 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:34:26.321839 [debug] [MainThread]: Connection 'model.my_dbt_project.user_segmentation' was properly closed.
[0m18:34:26.322838 [info ] [MainThread]: 
[0m18:34:26.323838 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m18:34:26.327835 [debug] [MainThread]: Command end result
[0m18:34:26.363815 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:34:26.368812 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:34:26.377808 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:34:26.378806 [info ] [MainThread]: 
[0m18:34:26.380807 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:26.383805 [info ] [MainThread]: 
[0m18:34:26.384804 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:34:26.386803 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:26.386803 after 4.19 seconds
[0m18:34:26.387801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024761143380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002476104A180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475CDF7500>]}
[0m18:34:26.388801 [debug] [MainThread]: Flushing usage events
[0m18:34:26.928492 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:34:30.475468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFA1F410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFA1F3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFA1F440>]}


============================== 18:34:30.481464 | 476f741f-17c8-4139-8d67-8559586528a8 ==============================
[0m18:34:30.481464 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:34:30.482462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:34:30.851254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFCBCE90>]}
[0m18:34:30.998169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DF264D40>]}
[0m18:34:31.000167 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:34:31.330981 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:34:31.538861 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:31.539860 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:31.545857 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:34:31.604824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFBBD2E0>]}
[0m18:34:31.720755 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:34:31.724753 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:34:31.776725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8E15C52B0>]}
[0m18:34:31.777723 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:34:31.779722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFE28EF0>]}
[0m18:34:31.785718 [info ] [MainThread]: 
[0m18:34:31.786718 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:34:31.787718 [info ] [MainThread]: 
[0m18:34:31.788717 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:34:31.797717 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:34:31.899653 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:34:31.899653 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:34:31.900653 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:31.956623 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m18:34:31.957621 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:34:31.958620 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:34:31.966615 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.007 seconds
[0m18:34:31.969613 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:34:31.970613 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:34:31.981607 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:31.982606 [debug] [MainThread]: On master: BEGIN
[0m18:34:31.983605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:32.028580 [debug] [MainThread]: SQL status: BEGIN in 0.045 seconds
[0m18:34:32.030579 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:32.030579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:34:32.040572 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m18:34:32.044572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '476f741f-17c8-4139-8d67-8559586528a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFDFAF60>]}
[0m18:34:32.045570 [debug] [MainThread]: On master: ROLLBACK
[0m18:34:32.045570 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:32.046570 [debug] [MainThread]: On master: BEGIN
[0m18:34:32.047570 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m18:34:32.048569 [debug] [MainThread]: On master: COMMIT
[0m18:34:32.049569 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:32.049569 [debug] [MainThread]: On master: COMMIT
[0m18:34:32.050569 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:32.051567 [debug] [MainThread]: On master: Close
[0m18:34:32.054565 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:34:32.055565 [info ] [Thread-1 (]: 1 of 17 START test not_null_example_email ...................................... [RUN]
[0m18:34:32.056564 [debug] [Thread-1 (]: Acquiring new postgres connection 'test.my_dbt_project.not_null_example_email.f6780dacc6'
[0m18:34:32.058564 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:34:32.080551 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:34:32.082549 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:34:32.101538 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:34:32.103537 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:34:32.104537 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: BEGIN
[0m18:34:32.105536 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:34:32.154507 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:34:32.155509 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:34:32.156507 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_email.f6780dacc6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select email
from "sales_db"."public"."example"
where email is null



      
    ) dbt_internal_test
[0m18:34:32.159505 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.165501 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: ROLLBACK
[0m18:34:32.166501 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_email.f6780dacc6: Close
[0m18:34:32.167500 [info ] [Thread-1 (]: 1 of 17 PASS not_null_example_email ............................................ [[32mPASS[0m in 0.11s]
[0m18:34:32.169502 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:34:32.170499 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:34:32.171500 [info ] [Thread-1 (]: 2 of 17 START test not_null_example_id ......................................... [RUN]
[0m18:34:32.172499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m18:34:32.173498 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:34:32.181492 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:34:32.182491 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:34:32.185490 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:34:32.187489 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:34:32.187489 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: BEGIN
[0m18:34:32.188490 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.246455 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m18:34:32.247456 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:34:32.248455 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_example_id.96691fbe5c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "sales_db"."public"."example"
where id is null



      
    ) dbt_internal_test
[0m18:34:32.252453 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.255451 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: ROLLBACK
[0m18:34:32.257449 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_example_id.96691fbe5c: Close
[0m18:34:32.258449 [info ] [Thread-1 (]: 2 of 17 PASS not_null_example_id ............................................... [[32mPASS[0m in 0.09s]
[0m18:34:32.260449 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:34:32.262448 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:34:32.263446 [info ] [Thread-1 (]: 3 of 17 START test not_null_order_status_summary_status ........................ [RUN]
[0m18:34:32.264447 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb)
[0m18:34:32.265445 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:34:32.274440 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:34:32.276439 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:34:32.279436 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:34:32.281436 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:34:32.282435 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: BEGIN
[0m18:34:32.284435 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.335405 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:34:32.336404 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:34:32.337403 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select status
from "sales_db"."public"."order_status_summary"
where status is null



      
    ) dbt_internal_test
[0m18:34:32.340402 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:34:32.342402 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: ROLLBACK
[0m18:34:32.343401 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb: Close
[0m18:34:32.344400 [info ] [Thread-1 (]: 3 of 17 PASS not_null_order_status_summary_status .............................. [[32mPASS[0m in 0.08s]
[0m18:34:32.346399 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:34:32.348398 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:34:32.349397 [info ] [Thread-1 (]: 4 of 17 START test not_null_order_status_summary_total_amount .................. [RUN]
[0m18:34:32.350396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb, now test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75)
[0m18:34:32.351396 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:34:32.358391 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:34:32.360390 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:34:32.366387 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:34:32.368387 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:34:32.370385 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: BEGIN
[0m18:34:32.370385 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.424355 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:34:32.425356 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:34:32.425356 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "sales_db"."public"."order_status_summary"
where total_amount is null



      
    ) dbt_internal_test
[0m18:34:32.428353 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.432349 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: ROLLBACK
[0m18:34:32.433349 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75: Close
[0m18:34:32.434349 [info ] [Thread-1 (]: 4 of 17 PASS not_null_order_status_summary_total_amount ........................ [[32mPASS[0m in 0.08s]
[0m18:34:32.436348 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:34:32.437356 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:34:32.437356 [info ] [Thread-1 (]: 5 of 17 START test not_null_order_status_summary_total_orders .................. [RUN]
[0m18:34:32.439347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75, now test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280)
[0m18:34:32.442345 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:34:32.450339 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:34:32.451340 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:34:32.455337 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:34:32.457335 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:34:32.458334 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: BEGIN
[0m18:34:32.459335 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.507307 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:34:32.508306 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:34:32.509305 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."order_status_summary"
where total_orders is null



      
    ) dbt_internal_test
[0m18:34:32.512305 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.515302 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: ROLLBACK
[0m18:34:32.515302 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280: Close
[0m18:34:32.517301 [info ] [Thread-1 (]: 5 of 17 PASS not_null_order_status_summary_total_orders ........................ [[32mPASS[0m in 0.08s]
[0m18:34:32.519300 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:34:32.520299 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:34:32.521299 [info ] [Thread-1 (]: 6 of 17 START test not_null_sales_by_month_month ............................... [RUN]
[0m18:34:32.523297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280, now test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a)
[0m18:34:32.524296 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:34:32.532292 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:34:32.534291 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:34:32.537289 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:34:32.539289 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:34:32.540288 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: BEGIN
[0m18:34:32.540288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.593258 [debug] [Thread-1 (]: SQL status: BEGIN in 0.053 seconds
[0m18:34:32.594257 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:34:32.594257 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select month
from "sales_db"."public"."sales_by_month"
where month is null



      
    ) dbt_internal_test
[0m18:34:32.598255 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.600253 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: ROLLBACK
[0m18:34:32.601253 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a: Close
[0m18:34:32.602252 [info ] [Thread-1 (]: 6 of 17 PASS not_null_sales_by_month_month ..................................... [[32mPASS[0m in 0.08s]
[0m18:34:32.604252 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:34:32.605251 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:34:32.606250 [info ] [Thread-1 (]: 7 of 17 START test not_null_sales_by_month_total_orders ........................ [RUN]
[0m18:34:32.607249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a, now test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f)
[0m18:34:32.608249 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:34:32.612247 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:34:32.615245 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:34:32.619242 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:34:32.621241 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:34:32.622241 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: BEGIN
[0m18:34:32.622241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.673211 [debug] [Thread-1 (]: SQL status: BEGIN in 0.050 seconds
[0m18:34:32.674212 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:34:32.675211 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."sales_by_month"
where total_orders is null



      
    ) dbt_internal_test
[0m18:34:32.678209 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:32.681207 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: ROLLBACK
[0m18:34:32.682207 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f: Close
[0m18:34:32.683206 [info ] [Thread-1 (]: 7 of 17 PASS not_null_sales_by_month_total_orders .............................. [[32mPASS[0m in 0.08s]
[0m18:34:32.685205 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:34:32.686210 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:34:32.687204 [info ] [Thread-1 (]: 8 of 17 START test not_null_sales_by_month_total_sales ......................... [RUN]
[0m18:34:32.688203 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f, now test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2)
[0m18:34:32.689203 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:34:32.697198 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:34:32.699198 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:34:32.703195 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:34:32.704194 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:34:32.705194 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: BEGIN
[0m18:34:32.706193 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.751167 [debug] [Thread-1 (]: SQL status: BEGIN in 0.045 seconds
[0m18:34:32.752167 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:34:32.753166 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_sales
from "sales_db"."public"."sales_by_month"
where total_sales is null



      
    ) dbt_internal_test
[0m18:34:32.757165 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.002 seconds
[0m18:34:32.759164 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: ROLLBACK
[0m18:34:32.759164 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2: Close
[0m18:34:32.761161 [info ] [Thread-1 (]: 8 of 17 PASS not_null_sales_by_month_total_sales ............................... [[32mPASS[0m in 0.07s]
[0m18:34:32.762162 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:34:32.764161 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:34:32.765160 [info ] [Thread-1 (]: 9 of 17 START test not_null_user_order_summary_total_amount .................... [RUN]
[0m18:34:32.766159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2, now test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6)
[0m18:34:32.767159 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:34:32.774155 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:34:32.776154 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:34:32.779152 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:34:32.782150 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:34:32.783150 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: BEGIN
[0m18:34:32.784149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.830123 [debug] [Thread-1 (]: SQL status: BEGIN in 0.046 seconds
[0m18:34:32.831123 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:34:32.832121 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_amount
from "sales_db"."public"."user_order_summary"
where total_amount is null



      
    ) dbt_internal_test
[0m18:34:32.837119 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:34:32.839118 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: ROLLBACK
[0m18:34:32.840117 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6: Close
[0m18:34:32.841116 [error] [Thread-1 (]: 9 of 17 FAIL 40 not_null_user_order_summary_total_amount ....................... [[31mFAIL 40[0m in 0.07s]
[0m18:34:32.843116 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:34:32.844115 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:34:32.845114 [info ] [Thread-1 (]: 10 of 17 START test not_null_user_order_summary_total_orders ................... [RUN]
[0m18:34:32.846114 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6, now test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c)
[0m18:34:32.847114 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:34:32.852110 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:34:32.853109 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:34:32.856108 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:34:32.858106 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:34:32.859107 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: BEGIN
[0m18:34:32.860106 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.911076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.051 seconds
[0m18:34:32.912076 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:34:32.913075 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_orders
from "sales_db"."public"."user_order_summary"
where total_orders is null



      
    ) dbt_internal_test
[0m18:34:32.918073 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:34:32.920072 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: ROLLBACK
[0m18:34:32.921071 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c: Close
[0m18:34:32.922069 [info ] [Thread-1 (]: 10 of 17 PASS not_null_user_order_summary_total_orders ......................... [[32mPASS[0m in 0.08s]
[0m18:34:32.925071 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:34:32.926068 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:34:32.926068 [info ] [Thread-1 (]: 11 of 17 START test not_null_user_order_summary_user_id ........................ [RUN]
[0m18:34:32.927068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c, now test.my_dbt_project.not_null_user_order_summary_user_id.744111b232)
[0m18:34:32.928067 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:34:32.936062 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:34:32.938061 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:34:32.942059 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:34:32.944057 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:34:32.945057 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: BEGIN
[0m18:34:32.946057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:32.994029 [debug] [Thread-1 (]: SQL status: BEGIN in 0.048 seconds
[0m18:34:32.995028 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:34:32.996028 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "sales_db"."public"."user_order_summary"
where user_id is null



      
    ) dbt_internal_test
[0m18:34:33.001026 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:34:33.003024 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: ROLLBACK
[0m18:34:33.004024 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_order_summary_user_id.744111b232: Close
[0m18:34:33.005022 [info ] [Thread-1 (]: 11 of 17 PASS not_null_user_order_summary_user_id .............................. [[32mPASS[0m in 0.08s]
[0m18:34:33.007022 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:34:33.008022 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:34:33.008022 [info ] [Thread-1 (]: 12 of 17 START test not_null_user_segmentation_frequency_segment ............... [RUN]
[0m18:34:33.009020 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_user_id.744111b232, now test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7)
[0m18:34:33.010020 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:34:33.017016 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:34:33.019015 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:34:33.021013 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:34:33.023013 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:34:33.024012 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: BEGIN
[0m18:34:33.025012 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.081979 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:34:33.082977 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:34:33.083977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select frequency_segment
from "sales_db"."public"."user_segmentation"
where frequency_segment is null



      
    ) dbt_internal_test
[0m18:34:33.084977 [debug] [Thread-1 (]: Postgres adapter: Postgres error: ERREUR:  la colonne « frequency_segment » n'existe pas
LINE 13: select frequency_segment
                ^

[0m18:34:33.085977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: ROLLBACK
[0m18:34:33.086977 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7: Close
[0m18:34:33.095970 [debug] [Thread-1 (]: Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql
[0m18:34:33.096970 [error] [Thread-1 (]: 12 of 17 ERROR not_null_user_segmentation_frequency_segment .................... [[31mERROR[0m in 0.09s]
[0m18:34:33.098970 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:34:33.099970 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:34:33.100968 [debug] [Thread-4 (]: Marking all children of 'test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7' to be skipped because of status 'error'.  Reason: Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql.
[0m18:34:33.101967 [info ] [Thread-1 (]: 13 of 17 START test not_null_user_segmentation_user_id ......................... [RUN]
[0m18:34:33.103966 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7, now test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3)
[0m18:34:33.103966 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:34:33.108963 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:34:33.109962 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:34:33.116959 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:34:33.118958 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:34:33.119957 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: BEGIN
[0m18:34:33.120957 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.176925 [debug] [Thread-1 (]: SQL status: BEGIN in 0.056 seconds
[0m18:34:33.177925 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:34:33.178924 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from "sales_db"."public"."user_segmentation"
where user_id is null



      
    ) dbt_internal_test
[0m18:34:33.184920 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:34:33.187918 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: ROLLBACK
[0m18:34:33.188917 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3: Close
[0m18:34:33.189918 [info ] [Thread-1 (]: 13 of 17 PASS not_null_user_segmentation_user_id ............................... [[32mPASS[0m in 0.09s]
[0m18:34:33.191917 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:34:33.193916 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:34:33.194915 [info ] [Thread-1 (]: 14 of 17 START test not_null_user_segmentation_value_segment ................... [RUN]
[0m18:34:33.196914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3, now test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8)
[0m18:34:33.197917 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:34:33.202909 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:34:33.203910 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:34:33.208907 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:34:33.210905 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:34:33.211905 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: BEGIN
[0m18:34:33.213907 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.274871 [debug] [Thread-1 (]: SQL status: BEGIN in 0.061 seconds
[0m18:34:33.275869 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:34:33.277868 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select value_segment
from "sales_db"."public"."user_segmentation"
where value_segment is null



      
    ) dbt_internal_test
[0m18:34:33.282864 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:34:33.284864 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: ROLLBACK
[0m18:34:33.285864 [debug] [Thread-1 (]: On test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8: Close
[0m18:34:33.286862 [info ] [Thread-1 (]: 14 of 17 PASS not_null_user_segmentation_value_segment ......................... [[32mPASS[0m in 0.09s]
[0m18:34:33.288862 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:34:33.289860 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:34:33.290860 [info ] [Thread-1 (]: 15 of 17 START test unique_example_id .......................................... [RUN]
[0m18:34:33.291859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m18:34:33.292859 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:34:33.308849 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:34:33.313847 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:34:33.318843 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:34:33.320843 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:34:33.321843 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: BEGIN
[0m18:34:33.323842 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.387804 [debug] [Thread-1 (]: SQL status: BEGIN in 0.064 seconds
[0m18:34:33.388803 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:34:33.389804 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_example_id.50f543cf6e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "sales_db"."public"."example"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:33.392801 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.003 seconds
[0m18:34:33.395800 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: ROLLBACK
[0m18:34:33.396799 [debug] [Thread-1 (]: On test.my_dbt_project.unique_example_id.50f543cf6e: Close
[0m18:34:33.397799 [info ] [Thread-1 (]: 15 of 17 PASS unique_example_id ................................................ [[32mPASS[0m in 0.11s]
[0m18:34:33.399798 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:34:33.401799 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:34:33.402795 [info ] [Thread-1 (]: 16 of 17 START test unique_user_order_summary_user_id .......................... [RUN]
[0m18:34:33.404794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_example_id.50f543cf6e, now test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04)
[0m18:34:33.405794 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:34:33.410791 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:34:33.412789 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:34:33.418786 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:34:33.420785 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:34:33.421785 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: BEGIN
[0m18:34:33.422784 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.480752 [debug] [Thread-1 (]: SQL status: BEGIN in 0.058 seconds
[0m18:34:33.481750 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:34:33.482750 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "sales_db"."public"."user_order_summary"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:33.487746 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.005 seconds
[0m18:34:33.489745 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: ROLLBACK
[0m18:34:33.490745 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04: Close
[0m18:34:33.491744 [info ] [Thread-1 (]: 16 of 17 PASS unique_user_order_summary_user_id ................................ [[32mPASS[0m in 0.09s]
[0m18:34:33.493744 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:34:33.494743 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:34:33.495744 [info ] [Thread-1 (]: 17 of 17 START test unique_user_segmentation_user_id ........................... [RUN]
[0m18:34:33.497743 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04, now test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd)
[0m18:34:33.498741 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:34:33.505736 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:34:33.507735 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:34:33.511734 [debug] [Thread-1 (]: Writing runtime sql for node "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:34:33.514732 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:34:33.515731 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: BEGIN
[0m18:34:33.516730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:33.573698 [debug] [Thread-1 (]: SQL status: BEGIN in 0.057 seconds
[0m18:34:33.574697 [debug] [Thread-1 (]: Using postgres connection "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:34:33.575696 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "node_id": "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    user_id as unique_field,
    count(*) as n_records

from "sales_db"."public"."user_segmentation"
where user_id is not null
group by user_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:34:33.580694 [debug] [Thread-1 (]: SQL status: SELECT 1 in 0.004 seconds
[0m18:34:33.581693 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: ROLLBACK
[0m18:34:33.582692 [debug] [Thread-1 (]: On test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd: Close
[0m18:34:33.583692 [info ] [Thread-1 (]: 17 of 17 PASS unique_user_segmentation_user_id ................................. [[32mPASS[0m in 0.09s]
[0m18:34:33.585692 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:34:33.587690 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:33.588690 [debug] [MainThread]: On master: BEGIN
[0m18:34:33.588690 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:33.636661 [debug] [MainThread]: SQL status: BEGIN in 0.048 seconds
[0m18:34:33.637662 [debug] [MainThread]: On master: COMMIT
[0m18:34:33.638661 [debug] [MainThread]: Using postgres connection "master"
[0m18:34:33.639660 [debug] [MainThread]: On master: COMMIT
[0m18:34:33.639660 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m18:34:33.640659 [debug] [MainThread]: On master: Close
[0m18:34:33.641659 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:33.642659 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:34:33.642659 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd' was properly closed.
[0m18:34:33.643658 [info ] [MainThread]: 
[0m18:34:33.644657 [info ] [MainThread]: Finished running 17 data tests in 0 hours 0 minutes and 1.85 seconds (1.85s).
[0m18:34:33.652652 [debug] [MainThread]: Command end result
[0m18:34:33.692629 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:34:33.696627 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:34:33.705623 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:34:33.706621 [info ] [MainThread]: 
[0m18:34:33.707622 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:34:33.709621 [info ] [MainThread]: 
[0m18:34:33.710620 [error] [MainThread]: [31mFailure in test not_null_user_order_summary_total_amount (models\schema.yaml)[0m
[0m18:34:33.711620 [error] [MainThread]:   Got 40 results, configured to fail if != 0
[0m18:34:33.713619 [info ] [MainThread]: 
[0m18:34:33.714617 [info ] [MainThread]:   compiled code at target\compiled\my_dbt_project\models\schema.yaml\not_null_user_order_summary_total_amount.sql
[0m18:34:33.715618 [info ] [MainThread]: 
[0m18:34:33.716616 [error] [MainThread]:   Database Error in test not_null_user_segmentation_frequency_segment (models\schema.yaml)
  ERREUR:  la colonne « frequency_segment » n'existe pas
  LINE 13: select frequency_segment
                  ^
  compiled code at target\run\my_dbt_project\models\schema.yaml\not_null_user_segmentation_frequency_segment.sql
[0m18:34:33.717615 [info ] [MainThread]: 
[0m18:34:33.718615 [info ] [MainThread]: Done. PASS=15 WARN=0 ERROR=2 SKIP=0 TOTAL=17
[0m18:34:33.721613 [debug] [MainThread]: Command `dbt test` failed at 18:34:33.721613 after 3.39 seconds
[0m18:34:33.722613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DFB34F80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DEBF91F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F8DEBF9AF0>]}
[0m18:34:33.723612 [debug] [MainThread]: Flushing usage events
[0m18:34:34.159363 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:34.137933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C238E51340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23AFAEA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23AFAE7E0>]}


============================== 18:35:34.143930 | e5c45613-d23b-48dd-bf2f-ed367f0b51a8 ==============================
[0m18:35:34.143930 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:35:34.145929 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:34.454752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23AABD3A0>]}
[0m18:35:34.550697 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23A8A9820>]}
[0m18:35:34.551697 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m18:35:34.856522 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:35:35.052410 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:35:35.052410 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:35:35.059407 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_dbt_project.example
[0m18:35:35.109378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23B8AA180>]}
[0m18:35:35.143358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D153A70>]}
[0m18:35:35.144359 [info ] [MainThread]: Found 5 models, 17 data tests, 2 sources, 431 macros
[0m18:35:35.146358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23CFAAB70>]}
[0m18:35:35.151354 [info ] [MainThread]: 
[0m18:35:35.152353 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:35:35.153353 [info ] [MainThread]: 
[0m18:35:35.154352 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m18:35:35.158350 [debug] [ThreadPool]: Acquiring new postgres connection 'list_sales_db_public'
[0m18:35:35.273285 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:35:35.274284 [debug] [ThreadPool]: On list_sales_db_public: BEGIN
[0m18:35:35.275284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:35.331253 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m18:35:35.332251 [debug] [ThreadPool]: Using postgres connection "list_sales_db_public"
[0m18:35:35.333250 [debug] [ThreadPool]: On list_sales_db_public: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "list_sales_db_public"} */
select
      'sales_db' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
    union all
    select
      'sales_db' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'public'
  
[0m18:35:35.341246 [debug] [ThreadPool]: SQL status: SELECT 7 in 0.008 seconds
[0m18:35:35.343245 [debug] [ThreadPool]: On list_sales_db_public: ROLLBACK
[0m18:35:35.344244 [debug] [ThreadPool]: On list_sales_db_public: Close
[0m18:35:35.355237 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:35.355237 [debug] [MainThread]: On master: BEGIN
[0m18:35:35.356237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:35:35.407209 [debug] [MainThread]: SQL status: BEGIN in 0.050 seconds
[0m18:35:35.407209 [debug] [MainThread]: Using postgres connection "master"
[0m18:35:35.408207 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m18:35:35.418202 [debug] [MainThread]: SQL status: SELECT 7 in 0.009 seconds
[0m18:35:35.422200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5c45613-d23b-48dd-bf2f-ed367f0b51a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23D52DF40>]}
[0m18:35:35.422200 [debug] [MainThread]: On master: ROLLBACK
[0m18:35:35.423199 [debug] [MainThread]: On master: Close
[0m18:35:35.427197 [debug] [Thread-1 (]: Began running node model.my_dbt_project.example
[0m18:35:35.429196 [debug] [Thread-1 (]: Acquiring new postgres connection 'model.my_dbt_project.example'
[0m18:35:35.429196 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.example
[0m18:35:35.437191 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.example"
[0m18:35:35.438190 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.example
[0m18:35:35.440189 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.example
[0m18:35:35.440189 [debug] [Thread-1 (]: Began running node model.my_dbt_project.order_status_summary
[0m18:35:35.441189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.example, now model.my_dbt_project.order_status_summary)
[0m18:35:35.442189 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.order_status_summary
[0m18:35:35.446186 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.order_status_summary"
[0m18:35:35.448185 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.order_status_summary
[0m18:35:35.449184 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.order_status_summary
[0m18:35:35.450184 [debug] [Thread-1 (]: Began running node model.my_dbt_project.sales_by_month
[0m18:35:35.451183 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.order_status_summary, now model.my_dbt_project.sales_by_month)
[0m18:35:35.452182 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.sales_by_month
[0m18:35:35.455181 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.sales_by_month"
[0m18:35:35.457179 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.sales_by_month
[0m18:35:35.458179 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.sales_by_month
[0m18:35:35.459179 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_order_summary
[0m18:35:35.459179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.sales_by_month, now model.my_dbt_project.user_order_summary)
[0m18:35:35.460178 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_order_summary
[0m18:35:35.465176 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_order_summary"
[0m18:35:35.466174 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_order_summary
[0m18:35:35.467175 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_order_summary
[0m18:35:35.468175 [debug] [Thread-1 (]: Began running node model.my_dbt_project.user_segmentation
[0m18:35:35.469172 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.user_order_summary, now model.my_dbt_project.user_segmentation)
[0m18:35:35.469172 [debug] [Thread-1 (]: Began compiling node model.my_dbt_project.user_segmentation
[0m18:35:35.473171 [debug] [Thread-1 (]: Writing injected SQL for node "model.my_dbt_project.user_segmentation"
[0m18:35:35.474170 [debug] [Thread-1 (]: Began executing node model.my_dbt_project.user_segmentation
[0m18:35:35.476170 [debug] [Thread-1 (]: Finished running node model.my_dbt_project.user_segmentation
[0m18:35:35.476170 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:35:35.477169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.my_dbt_project.user_segmentation, now test.my_dbt_project.not_null_example_email.f6780dacc6)
[0m18:35:35.478168 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:35:35.497157 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_email.f6780dacc6"
[0m18:35:35.499155 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:35:35.501155 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_email.f6780dacc6
[0m18:35:35.502154 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:35:35.502154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_email.f6780dacc6, now test.my_dbt_project.not_null_example_id.96691fbe5c)
[0m18:35:35.503153 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:35:35.510149 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_example_id.96691fbe5c"
[0m18:35:35.512148 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:35:35.513149 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_example_id.96691fbe5c
[0m18:35:35.514149 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:35:35.515148 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_example_id.96691fbe5c, now test.my_dbt_project.unique_example_id.50f543cf6e)
[0m18:35:35.515148 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:35:35.526141 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_example_id.50f543cf6e"
[0m18:35:35.527140 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:35:35.529139 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_example_id.50f543cf6e
[0m18:35:35.530139 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:35:35.531138 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_example_id.50f543cf6e, now test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb)
[0m18:35:35.532137 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:35:35.539133 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb"
[0m18:35:35.541131 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:35:35.543131 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb
[0m18:35:35.544130 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:35:35.545129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_status.f3347b33cb, now test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75)
[0m18:35:35.546129 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:35:35.550126 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75"
[0m18:35:35.552125 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:35:35.553126 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75
[0m18:35:35.554125 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:35:35.555124 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_amount.3d500cca75, now test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280)
[0m18:35:35.556123 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:35:35.563119 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280"
[0m18:35:35.565119 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:35:35.566118 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280
[0m18:35:35.567117 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:35:35.568116 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_order_status_summary_total_orders.09d7706280, now test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a)
[0m18:35:35.568116 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:35:35.573113 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a"
[0m18:35:35.575113 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:35:35.576112 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a
[0m18:35:35.577112 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:35:35.578111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_month.dfdeb1e14a, now test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f)
[0m18:35:35.579111 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:35:35.587106 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f"
[0m18:35:35.589104 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:35:35.590104 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f
[0m18:35:35.591103 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:35:35.592103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_orders.2e1be0716f, now test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2)
[0m18:35:35.593102 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:35:35.598099 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2"
[0m18:35:35.600099 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:35:35.601097 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2
[0m18:35:35.602097 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:35:35.603097 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_sales_by_month_total_sales.51db083ac2, now test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6)
[0m18:35:35.604096 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:35:35.610093 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6"
[0m18:35:35.612091 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:35:35.614091 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6
[0m18:35:35.614091 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:35:35.615089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_amount.f56e1203d6, now test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c)
[0m18:35:35.615089 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:35:35.620088 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c"
[0m18:35:35.621087 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:35:35.623085 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c
[0m18:35:35.623085 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:35:35.624086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_total_orders.f9fe7a892c, now test.my_dbt_project.not_null_user_order_summary_user_id.744111b232)
[0m18:35:35.625085 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:35:35.630081 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_order_summary_user_id.744111b232"
[0m18:35:35.632079 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:35:35.634079 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_order_summary_user_id.744111b232
[0m18:35:35.635078 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:35:35.635078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_order_summary_user_id.744111b232, now test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04)
[0m18:35:35.636078 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:35:35.644073 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04"
[0m18:35:35.646072 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:35:35.647072 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04
[0m18:35:35.648071 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:35:35.649070 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.unique_user_order_summary_user_id.157cda1b04, now test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7)
[0m18:35:35.650070 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:35:35.657065 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7"
[0m18:35:35.659064 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:35:35.661063 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7
[0m18:35:35.662062 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:35:35.663062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_frequency_segment.4c6ae1ecd7, now test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3)
[0m18:35:35.663062 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:35:35.668058 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3"
[0m18:35:35.669059 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:35:35.670058 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3
[0m18:35:35.671057 [debug] [Thread-1 (]: Began running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:35:35.671057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_user_id.ebbb4c51f3, now test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8)
[0m18:35:35.672057 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:35:35.676054 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8"
[0m18:35:35.678054 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:35:35.679053 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8
[0m18:35:35.680052 [debug] [Thread-1 (]: Began running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:35:35.681052 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.my_dbt_project.not_null_user_segmentation_value_segment.b8d15f7ea8, now test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd)
[0m18:35:35.682052 [debug] [Thread-1 (]: Began compiling node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:35:35.689047 [debug] [Thread-1 (]: Writing injected SQL for node "test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd"
[0m18:35:35.690046 [debug] [Thread-1 (]: Began executing node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:35:35.692046 [debug] [Thread-1 (]: Finished running node test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd
[0m18:35:35.694046 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:35:35.695044 [debug] [MainThread]: Connection 'list_sales_db_public' was properly closed.
[0m18:35:35.696045 [debug] [MainThread]: Connection 'test.my_dbt_project.unique_user_segmentation_user_id.801cd4e0fd' was properly closed.
[0m18:35:35.701041 [debug] [MainThread]: Command end result
[0m18:35:35.830968 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:35:35.836963 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:35:35.852954 [debug] [MainThread]: Wrote artifact RunExecutionResult to C:\Users\lenovo\my_dbt_project\target\run_results.json
[0m18:35:35.857951 [debug] [MainThread]: Acquiring new postgres connection 'generate_catalog'
[0m18:35:35.858950 [info ] [MainThread]: Building catalog
[0m18:35:35.874942 [debug] [ThreadPool]: Acquiring new postgres connection 'sales_db.information_schema'
[0m18:35:35.888934 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m18:35:35.889933 [debug] [ThreadPool]: On sales_db.information_schema: BEGIN
[0m18:35:35.890932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:35:35.946903 [debug] [ThreadPool]: SQL status: BEGIN in 0.056 seconds
[0m18:35:35.947900 [debug] [ThreadPool]: Using postgres connection "sales_db.information_schema"
[0m18:35:35.948901 [debug] [ThreadPool]: On sales_db.information_schema: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "my_dbt_project", "target_name": "dev", "connection_name": "sales_db.information_schema"} */

    
    

    select
        'sales_db' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            when 'm' then 'MATERIALIZED VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)
    where ((upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('user_order_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('order_status_summary')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('orders')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('sales_by_month')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('users')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('user_segmentation')) or (upper(sch.nspname) = upper('public') and
           upper(tbl.relname) = upper('example')))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p', 'm') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table, [m]aterialized view. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
[0m18:35:35.962891 [debug] [ThreadPool]: SQL status: SELECT 33 in 0.013 seconds
[0m18:35:35.969888 [debug] [ThreadPool]: On sales_db.information_schema: ROLLBACK
[0m18:35:35.970888 [debug] [ThreadPool]: On sales_db.information_schema: Close
[0m18:35:35.989876 [debug] [MainThread]: Wrote artifact CatalogArtifact to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m18:35:36.024855 [debug] [MainThread]: Wrote artifact WritableManifest to C:\Users\lenovo\my_dbt_project\target\manifest.json
[0m18:35:36.027854 [debug] [MainThread]: Wrote artifact SemanticManifest to C:\Users\lenovo\my_dbt_project\target\semantic_manifest.json
[0m18:35:36.028854 [info ] [MainThread]: Catalog written to C:\Users\lenovo\my_dbt_project\target\catalog.json
[0m18:35:36.030852 [debug] [MainThread]: Command `dbt docs generate` succeeded at 18:35:36.030852 after 2.13 seconds
[0m18:35:36.031852 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m18:35:36.032851 [debug] [MainThread]: Connection 'sales_db.information_schema' was properly closed.
[0m18:35:36.032851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23BCBDEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23CDFAA80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23CDF8380>]}
[0m18:35:36.033852 [debug] [MainThread]: Flushing usage events
[0m18:35:36.484594 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:35:44.095247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE49B61460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4C0D7FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4C2BDA90>]}


============================== 18:35:44.100244 | 98427d8f-62d7-4019-9d1f-9c799dd35849 ==============================
[0m18:35:44.100244 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:35:44.102244 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\lenovo\\my_dbt_project\\logs', 'profiles_dir': 'C:\\Users\\lenovo\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:35:44.420062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98427d8f-62d7-4019-9d1f-9c799dd35849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4BD3FA10>]}
[0m18:35:44.519004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98427d8f-62d7-4019-9d1f-9c799dd35849', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4C9E40B0>]}
[0m18:37:47.586039 [error] [MainThread]: Encountered an error:

[0m18:37:47.590018 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\cli\main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\site-packages\dbt\task\docs\serve.py", line 29, in run
    httpd.serve_forever()
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 323, in select
    r, w, _ = self._select(self._readers, self._writers, [], timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\lenovo\AppData\Local\Programs\Python\Python312\Lib\selectors.py", line 314, in _select
    r, w, x = select.select(r, w, w, timeout)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m18:37:47.593036 [debug] [MainThread]: Command `dbt docs serve` failed at 18:37:47.593036 after 123.65 seconds
[0m18:37:47.595016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4C8B9490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4CA9A2A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE4DB8B890>]}
[0m18:37:47.596033 [debug] [MainThread]: Flushing usage events
[0m18:37:48.079740 [debug] [MainThread]: An error was encountered while trying to flush usage events
